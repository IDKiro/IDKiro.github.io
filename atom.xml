<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>IDKiro&#39;s Pages</title>
  
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://www.idkiro.xyz/"/>
  <updated>2018-11-05T05:06:39.536Z</updated>
  <id>https://www.idkiro.xyz/</id>
  
  <author>
    <name>IDKiro</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Action Recognition PyTorch</title>
    <link href="https://www.idkiro.xyz/2018/11/05/MachineLearning/"/>
    <id>https://www.idkiro.xyz/2018/11/05/MachineLearning/</id>
    <published>2018-11-05T05:02:36.000Z</published>
    <updated>2018-11-05T05:06:39.536Z</updated>
    
    <content type="html"><![CDATA[<p>The network are based on CNNs and LSTMs.</p><a id="more"></a><h2 id="Environment"><a href="#Environment" class="headerlink" title="Environment"></a>Environment</h2><p>Python 3.6.5 (Anaconda 5.2.0):</p><p><a href="https://mirrors.tuna.tsinghua.edu.cn/anaconda/archive/" target="_blank" rel="noopener">https://mirrors.tuna.tsinghua.edu.cn/anaconda/archive/</a></p><p>pytorch 0.4.1 (CUDA 9.0):</p><p><a href="https://pytorch.org/" target="_blank" rel="noopener">https://pytorch.org/</a></p><h2 id="Data"><a href="#Data" class="headerlink" title="Data"></a>Data</h2><p>The training dataset structure:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">~/</span><br><span class="line">  data/</span><br><span class="line">    train_data/</span><br><span class="line">      .../ (directories of class names)</span><br><span class="line">        .../ (directories of video names)</span><br><span class="line">          ... (jpg files)</span><br><span class="line">    valid_data/</span><br><span class="line">      .../ (directories of class names)</span><br><span class="line">        .../ (directories of video names)</span><br><span class="line">          ... (jpg files)</span><br><span class="line">    save_model/</span><br><span class="line">      save_100.pth</span><br></pre></td></tr></table></figure><p>The test dataset structure:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">~/</span><br><span class="line">  test_data/</span><br><span class="line">    .../ (directories of class names)</span><br><span class="line">      .../ (directories of video names)</span><br><span class="line">        ... (jpg files)</span><br></pre></td></tr></table></figure><p>The data structure of the video training dataset:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">video_data/</span><br><span class="line">      .../ (directories of class names)</span><br><span class="line">        ... (avi files)</span><br></pre></td></tr></table></figure><p>Use <code>video2jpg.py</code> under the <code>utils</code> folder to convert avi to jpg:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python video2jpg.py video_root_directory image_root_directory</span><br></pre></td></tr></table></figure><p>Use <code>split_data.py</code> to move some of the training dataset to a validation dataset:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python split_data.py train_root_directory valid_root_directory</span><br></pre></td></tr></table></figure><h2 id="Start"><a href="#Start" class="headerlink" title="Start"></a>Start</h2><p>Use the following command to train the model:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python train.py data</span><br></pre></td></tr></table></figure><p>Optional parameters of command:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">--model DIR           path to model</span><br><span class="line">--arch ARCH           model architecture (default: alexnet)</span><br><span class="line">--lstm-layers LSTM    number of lstm layers (default: 1)</span><br><span class="line">--hidden-size HIDDEN  output size of LSTM hidden layers (default: 512)</span><br><span class="line">--fc-size FC_SIZE     size of fully connected layer before LSTM (default:</span><br><span class="line">                      1024)</span><br><span class="line">--epochs N            manual epoch number (default: 100)</span><br><span class="line">--lr LR               initial learning rate (default: 0.001)</span><br><span class="line">--optim OPTIM         optimizer (default: sgd)</span><br><span class="line">--momentum M          momentum (default: 0.9)</span><br><span class="line">--lr-step LR_STEP     learning rate decay frequency (default: 30)</span><br><span class="line">--batch-size N        mini-batch size (default: 1)</span><br><span class="line">--weight-decay W      weight decay (default: 1e-4)</span><br><span class="line">--workers N           number of data loading workers (default: 8)</span><br></pre></td></tr></table></figure><p>Use the following commands to test:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python test.py data/save_model/model_best.pth.tar test_data</span><br></pre></td></tr></table></figure><h2 id="Network"><a href="#Network" class="headerlink" title="Network"></a>Network</h2><p>This project is based on CNNs and LSTMs. </p><div align="center"><br>  <img src="/2018/11/05/MachineLearning/lstm.jpg"><br></div><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><p><a href="https://github.com/chaoyuaw/pytorch-coviar.git" target="_blank" rel="noopener">https://github.com/chaoyuaw/pytorch-coviar.git</a></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;The network are based on CNNs and LSTMs.&lt;/p&gt;
    
    </summary>
    
      <category term="编程" scheme="https://www.idkiro.xyz/categories/%E7%BC%96%E7%A8%8B/"/>
    
    
      <category term="机器学习" scheme="https://www.idkiro.xyz/tags/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/"/>
    
      <category term="pytorch" scheme="https://www.idkiro.xyz/tags/pytorch/"/>
    
      <category term="动作识别" scheme="https://www.idkiro.xyz/tags/%E5%8A%A8%E4%BD%9C%E8%AF%86%E5%88%AB/"/>
    
  </entry>
  
  <entry>
    <title>Vue.js 入门学习笔记：电子书阅读器——目录和书签</title>
    <link href="https://www.idkiro.xyz/2018/10/14/VuejsEbook10/"/>
    <id>https://www.idkiro.xyz/2018/10/14/VuejsEbook10/</id>
    <published>2018-10-14T12:43:52.000Z</published>
    <updated>2018-10-14T12:44:49.587Z</updated>
    
    <content type="html"><![CDATA[<p>自行开发的网页端电子书阅读器，本系列用于记录开发过程中的各种问题，本文为阅读器主界面中菜单栏中目录和书签的实现。</p><a id="more"></a><h1 id="Content-vue-目录和书签"><a href="#Content-vue-目录和书签" class="headerlink" title="Content.vue: 目录和书签"></a>Content.vue: 目录和书签</h1><p>电子书阅读器主界面的菜单栏中目录和书签的实现。</p><h2 id="页面构成"><a href="#页面构成" class="headerlink" title="页面构成"></a>页面构成</h2><p>目录和书签组件顶部部分为目录/书签切换按钮，主体部分为目录和书签的内容。</p><h2 id="目录和书签切换"><a href="#目录和书签切换" class="headerlink" title="目录和书签切换"></a>目录和书签切换</h2><p>目录和书签切换时的显示效果改变和主题切换时一个思路，通过绑定 <code>class</code> 和相应的点击调用函数来实现样式的改变。</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"content-bookmark"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"changeTag"</span> <span class="attr">:class</span>=<span class="string">"&#123;'selected': chooseContentOrBookmark === true&#125;"</span> @<span class="attr">click</span>=<span class="string">"chooseContent"</span>&gt;</span>目录<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"changeTag"</span> <span class="attr">:class</span>=<span class="string">"&#123;'selected': chooseContentOrBookmark === false&#125;"</span> @<span class="attr">click</span>=<span class="string">"chooseBookmark"</span>&gt;</span>书签<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><p>通过 <code>v-show</code> 指令和 <code>chooseContentOrBookmark</code> 决定目录和书签的显示与否。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">chooseContent () &#123;</span><br><span class="line">  <span class="keyword">this</span>.chooseContentOrBookmark = <span class="literal">true</span></span><br><span class="line">&#125;,</span><br><span class="line">chooseBookmark () &#123;</span><br><span class="line">  <span class="keyword">this</span>.chooseContentOrBookmark = <span class="literal">false</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>背景颜色可以参考 Element-UI 提供的RGB值。</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&amp;<span class="selector-class">.selected</span> &#123;</span><br><span class="line">  <span class="attribute">background</span>: <span class="number">#F2F6FC</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="目录"><a href="#目录" class="headerlink" title="目录"></a>目录</h2><p>目录的列表渲染和主题的列表渲染方式一致，使用 <code>v-for</code> 指令监听列表项的点击事件。<code>Ebook</code> 组件生成 <code>navigation</code> 后保存在 <code>state</code> 中，并使用计算属性进行调用。遍历导航中的目录属性 <code>navigation.toc</code> 即可获取目录的标题和对应的位置链接。为了在目录未生成时显示提示，需要使用 <code>v-if</code> 和 <code>v-else</code> 进行条件渲染。</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"content-wrapper"</span> <span class="attr">v-if</span>=<span class="string">"bookAvailable"</span> <span class="attr">v-show</span>=<span class="string">"chooseContentOrBookmark"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">vue-scroll</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"content-item"</span></span></span><br><span class="line"><span class="tag">      <span class="attr">v-for</span>=<span class="string">"(item, index) in navigation.toc"</span></span></span><br><span class="line"><span class="tag">      <span class="attr">:key</span>=<span class="string">"index"</span></span></span><br><span class="line"><span class="tag">      @<span class="attr">click</span>=<span class="string">"jumpTo(item.href)"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"text"</span>&gt;</span>&#123;&#123;item.label&#125;&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">vue-scroll</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"empty"</span> <span class="attr">v-else</span> <span class="attr">v-show</span>=<span class="string">"chooseContentOrBookmark"</span>&gt;</span>加载中...<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><p><code>jumpTo</code> 方法即目录的跳转方法，参数为目标链接。因为 <code>jumpTo</code> 方法在 <code>Ebook</code> 组件中，所以需要先调用父组件 <code>MenuBar</code> 的同名方法，再调用父组件的父组件的同名方法。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">jumpTo (href) &#123;</span><br><span class="line">  <span class="keyword">this</span>.rendition.display(href)</span><br><span class="line">  <span class="keyword">this</span>.hideTitleAndMenu()</span><br><span class="line">  <span class="keyword">this</span>.pageChanged()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="书签"><a href="#书签" class="headerlink" title="书签"></a>书签</h2><p>书签和目录的方法基本一致。</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"content-wrapper"</span> <span class="attr">v-if</span>=<span class="string">"bookmarks"</span> <span class="attr">v-show</span>=<span class="string">"!chooseContentOrBookmark"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">vue-scroll</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"content-item"</span></span></span><br><span class="line"><span class="tag">      <span class="attr">v-for</span>=<span class="string">"(item, index) in bookmarks"</span></span></span><br><span class="line"><span class="tag">      <span class="attr">:key</span>=<span class="string">"index"</span></span></span><br><span class="line"><span class="tag">      @<span class="attr">click</span>=<span class="string">"turnMarkPage(index)"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"text"</span>&gt;</span>&#123;&#123;item.title&#125;&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">vue-scroll</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"empty"</span> <span class="attr">v-else</span> <span class="attr">v-show</span>=<span class="string">"!chooseContentOrBookmark"</span>&gt;</span>您还没有添加书签哦~<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><p>这里条件渲染则是根据书签有没有被定义，在 <code>Ebook</code> 组件中 <code>bookmarks</code> 只有在存在项时才定义为数组，为空时定义为 <code>undefined</code>.</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (!<span class="keyword">this</span>.bookmarks) &#123;</span><br><span class="line">  <span class="keyword">this</span>.$store.commit(<span class="string">'setBookmarks'</span>, [])</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (<span class="keyword">this</span>.bookmarks.length &lt; <span class="number">1</span>) &#123;</span><br><span class="line">  <span class="keyword">this</span>.$store.commit(<span class="string">'setBookmarks'</span>, <span class="literal">undefined</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>书签的跳转方法则类似于进度条跳转，使用的是 CFI。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">turnMarkPage (index) &#123;</span><br><span class="line">  <span class="keyword">this</span>.rendition.display(<span class="keyword">this</span>.bookmarks[index].cfi)</span><br><span class="line">  <span class="keyword">this</span>.hideTitleAndMenu()</span><br><span class="line">  <span class="keyword">this</span>.pageChanged()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="切换动画"><a href="#切换动画" class="headerlink" title="切换动画"></a>切换动画</h2><p>目录的切换动画和标题栏、菜单栏完全一致，只需要将方向从纵轴改为横轴即可。</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&amp;<span class="selector-class">.slide-right-enter</span>, &amp;<span class="selector-class">.slide-right-leave-to</span> &#123;</span><br><span class="line">    <span class="attribute">transform</span>: <span class="built_in">translate3d</span>(-100%, 0, 0);</span><br><span class="line">&#125;</span><br><span class="line">&amp;<span class="selector-class">.slide-right-enter-to</span>, &amp;<span class="selector-class">.slide-right-leave</span> &#123;</span><br><span class="line">    <span class="attribute">transform</span>: <span class="built_in">translate3d</span>(0, 0, 0);</span><br><span class="line">&#125;</span><br><span class="line">&amp;<span class="selector-class">.slide-right-enter-active</span>, &amp;<span class="selector-class">.slide-right-leave-active</span> &#123;</span><br><span class="line">    <span class="attribute">transition</span>: all .<span class="number">3s</span> linear;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;自行开发的网页端电子书阅读器，本系列用于记录开发过程中的各种问题，本文为阅读器主界面中菜单栏中目录和书签的实现。&lt;/p&gt;
    
    </summary>
    
      <category term="文档" scheme="https://www.idkiro.xyz/categories/%E6%96%87%E6%A1%A3/"/>
    
    
      <category term="开发" scheme="https://www.idkiro.xyz/tags/%E5%BC%80%E5%8F%91/"/>
    
      <category term="阅读器" scheme="https://www.idkiro.xyz/tags/%E9%98%85%E8%AF%BB%E5%99%A8/"/>
    
      <category term="网页应用" scheme="https://www.idkiro.xyz/tags/%E7%BD%91%E9%A1%B5%E5%BA%94%E7%94%A8/"/>
    
  </entry>
  
  <entry>
    <title>Vue.js 入门学习笔记：电子书阅读器——菜单栏</title>
    <link href="https://www.idkiro.xyz/2018/10/14/VuejsEbook9/"/>
    <id>https://www.idkiro.xyz/2018/10/14/VuejsEbook9/</id>
    <published>2018-10-14T12:43:00.000Z</published>
    <updated>2018-10-14T12:43:45.354Z</updated>
    
    <content type="html"><![CDATA[<p>自行开发的网页端电子书阅读器，本系列用于记录开发过程中的各种问题，本文为阅读器主界面中菜单栏的实现。</p><a id="more"></a><h1 id="MenuBar-vue-菜单栏"><a href="#MenuBar-vue-菜单栏" class="headerlink" title="MenuBar.vue: 菜单栏"></a>MenuBar.vue: 菜单栏</h1><p>电子书阅读器主界面的菜单栏的实现，不包含目录和书签。</p><h2 id="页面构成"><a href="#页面构成" class="headerlink" title="页面构成"></a>页面构成</h2><p>菜单栏分为两级，当点击蒙版中央时仅弹出第一级菜单栏，此时需要点击菜单栏的选项才会继续弹出相应的设置项。二级菜单分别为书签/目录、进度、主题、字体，其中书签/目录实现较为复杂，用子组件的方式进行实现，并且为了配合书签/目录，增加了显示书签/目录后遮盖书签的蒙版，突出书签/目录内容。其他的二级菜单栏使用 <code>state</code> 中的状态变量来进行控制，并配合上滑的动画。其中字体的设置滑块和进度条的实现使用了 Element-UI，自行实现方法在笔记最后贴出。</p><h2 id="二级菜单的切换"><a href="#二级菜单的切换" class="headerlink" title="二级菜单的切换"></a>二级菜单的切换</h2><p>在第一个动画标签中包含了第一级菜单和菜单上的四个点击按钮。</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">transition</span> <span class="attr">name</span>=<span class="string">"slide-up"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"menu-wrapper"</span> <span class="attr">:class</span>=<span class="string">"&#123;'hideBoxShadow': ifSettingShow || !ifTitleAndMenuShow&#125;"</span></span></span><br><span class="line"><span class="tag">      <span class="attr">v-show</span>=<span class="string">"ifTitleAndMenuShow"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"icon-wrapper"</span> @<span class="attr">click</span>=<span class="string">"showSetting(3)"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"icon-contents icon"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"icon-wrapper"</span> @<span class="attr">click</span>=<span class="string">"showSetting(2)"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"icon-Progress-read icon"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"icon-wrapper"</span> @<span class="attr">click</span>=<span class="string">"showSetting(1)"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"icon-brightness-contrast icon"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"icon-wrapper"</span> @<span class="attr">click</span>=<span class="string">"showSetting(0)"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"icon"</span>&gt;</span>A<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">transition</span>&gt;</span></span><br></pre></td></tr></table></figure><p>点击不同的按钮调用同一个函数，但是传递的参数不同。特别的，点击目录时不仅要唤醒目录还要隐藏一级菜单，点击进度条时并且书籍进度加载完成时需要读取当前的阅读进度，该函数使用和添加书签时类似。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">showSetting (tag) &#123;</span><br><span class="line">  <span class="keyword">if</span> (tag === <span class="number">3</span>) &#123;</span><br><span class="line">    <span class="keyword">this</span>.ifSettingShow = <span class="literal">false</span></span><br><span class="line">    <span class="keyword">this</span>.ifContentShow = <span class="literal">true</span></span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">this</span>.ifSettingShow = <span class="literal">true</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (tag === <span class="number">2</span> &amp;&amp; <span class="keyword">this</span>.bookAvailable) &#123;</span><br><span class="line">    <span class="keyword">this</span>.$emit(<span class="string">'getCurrentLocation'</span>)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">this</span>.showTag = tag</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>因为除了目录以外的二级菜单项位置一样，所以可以作为同一个元素的子元素，并且使用 <code>v-if</code> 和 <code>v-else-if</code> 来决定渲染，判断的值便是 <code>showSetting</code> 中的 <code>showTag</code> 值。</p><h2 id="字体切换"><a href="#字体切换" class="headerlink" title="字体切换"></a>字体切换</h2><p>字体切换的实现较为简单，两端显示字体列表中最小和最大的字体所能显示的 A，中间则为离散显示的进度条。使用 <code>show-stops</code> 声明进度条显示离散点，绑定 <code>min</code>、<code>max</code> 和 <code>step</code> 属性来实现选择字体的选项和字体列表中的值对应。</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"setting-font-size"</span> <span class="attr">v-if</span>=<span class="string">"showTag === 0"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"preview"</span> <span class="attr">:style</span>=<span class="string">"&#123;fontSize: fontSizeList[0].fontSize + 'px'&#125;"</span>&gt;</span>A<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">el-slider</span> <span class="attr">class</span>=<span class="string">"select"</span></span></span><br><span class="line"><span class="tag">              <span class="attr">:style</span>=<span class="string">"&#123;fontSize: '.5rem', padding: '.4rem .15rem'&#125;"</span></span></span><br><span class="line"><span class="tag">              <span class="attr">:min</span>=<span class="string">"12"</span></span></span><br><span class="line"><span class="tag">              <span class="attr">:max</span>=<span class="string">"24"</span></span></span><br><span class="line"><span class="tag">              <span class="attr">:step</span>=<span class="string">"2"</span></span></span><br><span class="line"><span class="tag">              <span class="attr">v-model</span>=<span class="string">"currentFontSize"</span></span></span><br><span class="line"><span class="tag">              <span class="attr">:show-tooltip</span>=<span class="string">"false"</span></span></span><br><span class="line"><span class="tag">              @<span class="attr">change</span>=<span class="string">"setFontSize(currentFontSize)"</span></span></span><br><span class="line"><span class="tag">              <span class="attr">show-stops</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">el-slider</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"preview"</span> <span class="attr">:style</span>=<span class="string">"&#123;fontSize: fontSizeList[fontSizeList.length - 1].fontSize + 'px'&#125;"</span>&gt;</span>A<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><p><code>v-model</code> 用于将进度条的值和实例中的变量进行绑定，使得进度条的值改变时可以让其他函数进行调用。</p><blockquote><p>需要使用 <code>mouted</code> 将字体选择滑块的数据与 state 中的数据进行同步，否则每次进入阅读滑块都会回到初始设定位置。</p></blockquote><p><code>@change=&quot;setFontSize(currentFontSize)&quot;</code> 则定义了进度条松开时并且进度条值发生变化调用的函数，这里需要使用 <code>$emit</code> 调用父组件的函数。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">setFontSize (fontSize) &#123;</span><br><span class="line">  <span class="keyword">this</span>.$store.commit(<span class="string">'setDefaultFontSize'</span>, fontSize)</span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">this</span>.themes) &#123;</span><br><span class="line">    <span class="keyword">this</span>.themes.fontSize(fontSize + <span class="string">'px'</span>)</span><br><span class="line">  &#125;</span><br><span class="line">  localStorage.setItem(<span class="string">'defaultFontSize'</span>, fontSize)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="主题切换"><a href="#主题切换" class="headerlink" title="主题切换"></a>主题切换</h2><p>主题的切换和字体的切换类似，都要调用父组件的函数来进行 <code>theme</code> 的修改，但是主题需要对列表中的主题对象进行逐个渲染，然后排列在菜单中供选择。列表对象的渲染要用到 <code>v-for</code> 指令：<code>v-for=&quot;(item, index) in themeList&quot; :key=&quot;index&quot;</code>。</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"setting-theme"</span> <span class="attr">v-else-if</span>=<span class="string">"showTag === 1"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"setting-theme-item"</span> <span class="attr">v-for</span>=<span class="string">"(item, index) in themeList"</span> <span class="attr">:key</span>=<span class="string">"index"</span> @<span class="attr">click</span>=<span class="string">"setTheme(index)"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"preview"</span> <span class="attr">:style</span>=<span class="string">"&#123;background: item.style.body.background&#125;"</span> <span class="attr">:class</span>=<span class="string">"&#123;'no-border': item.style.body.background !=='#fff'&#125;"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"text"</span> <span class="attr">:class</span>=<span class="string">"&#123;'selected': index === defaultTheme&#125;"</span>&gt;</span>&#123;&#123;item.name&#125;&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><p>使用索引值作为 <code>setTheme()</code> 的输入参数，就可以实现主题的切换。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">setTheme (index) &#123;</span><br><span class="line">  <span class="keyword">this</span>.themes.select(<span class="keyword">this</span>.themeList[index].name)</span><br><span class="line">  <span class="keyword">this</span>.$store.commit(<span class="string">'setDefaultTheme'</span>, index)</span><br><span class="line">  localStorage.setItem(<span class="string">'defaultTheme'</span>, index)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>主题选择这边的关键在于渲染主题选项，每个主题选项都包含一个预览框和对应的主题名。其中预览框通过绑定 <code>style</code> 就可以实现 <code>div</code> 背景色的改变。特别的，白色背景为了和菜单栏进行区分，定义了 <code>:class=&quot;{&#39;no-border&#39;: item.style.body.background !==&#39;#fff&#39;}&quot;</code>，使得只有白色背景时才会渲染边框，当然这同样可以通过绑定 <code>style</code> 实现。</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&amp;<span class="selector-class">.no-border</span> &#123;</span><br><span class="line">  <span class="attribute">border</span>: none;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>主题名在被选中和非选中时显示为两种颜色，这同样通过绑定 <code>class</code> 并设置条件实现：<code>:class=&quot;{&#39;selected&#39;: index === defaultTheme}&quot;</code>。</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&amp;<span class="selector-class">.selected</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#555555</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="进度条实现"><a href="#进度条实现" class="headerlink" title="进度条实现"></a>进度条实现</h2><p>进度条显示的实现比字体更为简单，进度条下的进度文字显示则使用了双向绑定，在电子书加载前后显示不同的字符串。</p><blockquote><p>双向绑定中的值可以使用表达式进行，可以看做计算属性的行内表达，如果该值多次复用则最好使用计算属性。</p></blockquote><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"setting-progress"</span> <span class="attr">v-else-if</span>=<span class="string">"showTag === 2"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">el-slider</span> <span class="attr">v-model</span>=<span class="string">"progress"</span></span></span><br><span class="line"><span class="tag">              <span class="attr">:style</span>=<span class="string">"&#123;fontSize: '.5rem', padding: '.1rem 1rem'&#125;"</span></span></span><br><span class="line"><span class="tag">              <span class="attr">:show-tooltip</span>=<span class="string">"false"</span></span></span><br><span class="line"><span class="tag">              @<span class="attr">change</span>=<span class="string">"onProgressChange"</span>&gt;</span><span class="tag">&lt;/<span class="name">el-slider</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"text-wrapper"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">span</span>&gt;</span>&#123;&#123;bookAvailable ? progress + '%' : '加载中...'&#125;&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><p><code>progress</code> 的值在这里需要实时更新，要响应翻页时的进度变化，这里使用了监听组件 <code>watch</code> 和计算属性共同实现。计算属性自动更新进度的值，<code>watch</code> 则对计算属性的值进行监听，改变时进行取整处理并更新 <code>progress</code> 的值。</p><p>watch:</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">bookCurrentLocation () &#123;</span><br><span class="line">  <span class="keyword">this</span>.progress = <span class="built_in">Math</span>.round(<span class="keyword">this</span>.bookCurrentLocation)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>computed:</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">bookCurrentLocation () &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">this</span>.$store.state.bookCurrentLocation</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>onProgressChange</code> 则调用的是父组件的方法，在拖动进度条后调用实现阅读进度的跳转。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">onProgressChange (progress) &#123;</span><br><span class="line">  <span class="keyword">const</span> percentage = progress / <span class="number">100</span></span><br><span class="line">  <span class="keyword">const</span> location = percentage &gt; <span class="number">0</span> ? <span class="keyword">this</span>.location.cfiFromPercentage(percentage) : <span class="number">0</span></span><br><span class="line">  <span class="keyword">this</span>.rendition.display(location)</span><br><span class="line">  <span class="keyword">this</span>.pageChanged()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="切换动画"><a href="#切换动画" class="headerlink" title="切换动画"></a>切换动画</h2><p>蒙版的动画较为简单，在切出目录的时候加入蒙版，使用的动画类型是透明度的变化，类似于淡出。</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&amp;<span class="selector-class">.fade-enter</span>, &amp;<span class="selector-class">.fade-leave-to</span> &#123;</span><br><span class="line">  <span class="attribute">opacity</span>: <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line">&amp;<span class="selector-class">.fade-enter-to</span>, &amp;<span class="selector-class">.fade-leave</span> &#123;</span><br><span class="line">  <span class="attribute">opacity</span>: <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line">&amp;<span class="selector-class">.fade-enter-active</span>, &amp;<span class="selector-class">.fade-leave-active</span> &#123;</span><br><span class="line">  <span class="attribute">transition</span>: all .<span class="number">3s</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>菜单栏的切换动画和标题栏类似，只是方向有所区别。但是因为存在两级菜单，为了使得两级菜单在一同滑出时的速度一致，将二级菜单的动画的移动长度改为 <code>px2rem(108)</code>，相当于二级菜单和一级菜单的高度相加。</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&amp;<span class="selector-class">.slide-up-enter</span>, &amp;<span class="selector-class">.slide-up-leave-to</span> &#123;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translate3d</span>(0, 100%, 0);</span><br><span class="line">&#125;</span><br><span class="line">&amp;<span class="selector-class">.slide-up-enter-to</span>, &amp;<span class="selector-class">.slide-up-leave</span> &#123;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translate3d</span>(0, 0, 0);</span><br><span class="line">&#125;</span><br><span class="line">&amp;<span class="selector-class">.slide-up-enter-active</span>, &amp;<span class="selector-class">.slide-up-leave-active</span> &#123;</span><br><span class="line">  <span class="attribute">transition</span>: all .<span class="number">3s</span> linear;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="不使用-element-ui-实现进度条和字体切换滑块的方法"><a href="#不使用-element-ui-实现进度条和字体切换滑块的方法" class="headerlink" title="不使用 element-ui 实现进度条和字体切换滑块的方法"></a>不使用 element-ui 实现进度条和字体切换滑块的方法</h2><p>初期未使用 element-ui 时使用的方法，列出作为参考</p><h3 id="进度条"><a href="#进度条" class="headerlink" title="进度条"></a>进度条</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"progress-wrapper"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"range"</span> <span class="attr">class</span>=<span class="string">"progress"</span> <span class="attr">max</span>=<span class="string">"100"</span> <span class="attr">min</span>=<span class="string">"0"</span> <span class="attr">step</span>=<span class="string">"1"</span></span></span><br><span class="line"><span class="tag">          @<span class="attr">change</span>=<span class="string">"onProgressChange($event.target.value)"</span></span></span><br><span class="line"><span class="tag">          @<span class="attr">input</span>=<span class="string">"onProgressInput($event.target.value)"</span></span></span><br><span class="line"><span class="tag">          <span class="attr">:value</span>=<span class="string">"progress"</span></span></span><br><span class="line"><span class="tag">          <span class="attr">:disabled</span>=<span class="string">"!$store.state.bookAvailable"</span></span></span><br><span class="line"><span class="tag">          <span class="attr">ref</span>=<span class="string">"progress"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">onProgressChange (progress) &#123;</span><br><span class="line">  <span class="keyword">this</span>.$emit(<span class="string">'onProgressChange'</span>, progress)</span><br><span class="line">&#125;,</span><br><span class="line">onProgressInput (progress) &#123;</span><br><span class="line">  <span class="keyword">this</span>.progress = progress</span><br><span class="line">  <span class="keyword">this</span>.$refs.progress.style.backgroundSize = <span class="string">`<span class="subst">$&#123;<span class="keyword">this</span>.progress&#125;</span>% 100%`</span></span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 进度条背景百分比改变</span></span><br><span class="line"><span class="keyword">this</span>.$refs.progress.style.backgroundSize = <span class="string">`<span class="subst">$&#123;<span class="keyword">this</span>.progress&#125;</span>% 100%`</span></span><br></pre></td></tr></table></figure><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.progress-wrapper</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="built_in">px2rem</span>(40);</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">0</span> <span class="built_in">px2rem</span>(30);</span><br><span class="line">  <span class="attribute">box-sizing</span>: border-box;</span><br><span class="line">  @include center;</span><br><span class="line">  <span class="selector-class">.progress</span> &#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="built_in">px2rem</span>(2);</span><br><span class="line">    <span class="attribute">-webkit-appearance</span>: none;</span><br><span class="line">    <span class="attribute">background</span>: <span class="built_in">-webkit-linear-gradient</span>(#999, #999) no-repeat, <span class="number">#ddd</span>;</span><br><span class="line">    <span class="attribute">background-size</span>: <span class="number">0</span> <span class="number">100%</span>;</span><br><span class="line">    &amp;:focus &#123;</span><br><span class="line">      <span class="selector-tag">outline</span>: <span class="selector-tag">none</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    &amp;<span class="selector-pseudo">::-webkit-slider-thumb</span> &#123;</span><br><span class="line">      <span class="attribute">-webkit-appearance</span>: none;</span><br><span class="line">      <span class="attribute">height</span>:<span class="built_in">px2rem</span>(20);</span><br><span class="line">      <span class="attribute">width</span>: <span class="built_in">px2rem</span>(20);</span><br><span class="line">      <span class="attribute">border-radius</span>: <span class="number">50%</span>;</span><br><span class="line">      <span class="attribute">background</span>: <span class="number">#fff</span>;</span><br><span class="line">      <span class="attribute">border</span>: <span class="built_in">px2rem</span>(1) solid <span class="number">#ccc</span>;</span><br><span class="line">      <span class="attribute">box-shadow</span>: <span class="number">0</span> <span class="built_in">px2rem</span>(3) <span class="built_in">px2rem</span>(3) <span class="built_in">rgba</span>(0, 0, 0, .15);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="字体切换滑块"><a href="#字体切换滑块" class="headerlink" title="字体切换滑块"></a>字体切换滑块</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"select"</span> <span class="attr">:style</span>=<span class="string">"&#123;'margin-left': -lineHalfLength + 'px', 'margin-right': -lineHalfLength + 'px'&#125;"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"select-wrapper"</span> <span class="attr">v-for</span>=<span class="string">"(item, index) in $store.state.fontSizeList"</span> <span class="attr">:key</span>=<span class="string">"index"</span> @<span class="attr">click</span>=<span class="string">"setFontSize(item.fontSize)"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"line"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"point-wrapper"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"point"</span> <span class="attr">v-show</span>=<span class="string">"defaultFontSize===item.fontSize"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"small-point"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"line"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lineHalfLength: (<span class="built_in">document</span>.body.clientWidth - <span class="number">160</span> / <span class="number">3</span>) / <span class="number">14</span>,</span><br></pre></td></tr></table></figure><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.select-wrapper</span> &#123;</span><br><span class="line">  &amp;:first-child &#123;</span><br><span class="line">    <span class="selector-class">.line</span> &#123;</span><br><span class="line">      &amp;:first-child &#123;</span><br><span class="line">        <span class="selector-tag">border</span>: <span class="selector-tag">none</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  &amp;<span class="selector-pseudo">:last-child</span> &#123;</span><br><span class="line">    .line &#123;</span><br><span class="line">      &amp;<span class="selector-pseudo">:last-child</span> &#123;</span><br><span class="line">        <span class="attribute">border</span>: none;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="selector-tag">display</span>: <span class="selector-tag">flex</span>;</span><br><span class="line">  <span class="selector-tag">flex</span>: 1;</span><br><span class="line">  <span class="selector-tag">align-items</span>: <span class="selector-tag">center</span>;</span><br><span class="line">  <span class="selector-class">.line</span> &#123;</span><br><span class="line">    <span class="attribute">flex</span>: <span class="number">1</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">border-top</span>: <span class="number">#ccc</span> solid <span class="built_in">px2rem</span>(1);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="selector-class">.point-wrapper</span> &#123;</span><br><span class="line">    <span class="attribute">position</span>: relative;</span><br><span class="line">    <span class="attribute">flex</span>: <span class="number">0</span> <span class="number">0</span> <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="built_in">px2rem</span>(7);</span><br><span class="line">    <span class="attribute">border-left</span>: <span class="number">#ccc</span> solid <span class="built_in">px2rem</span>(1);</span><br><span class="line">    @include center;</span><br><span class="line">    <span class="selector-class">.point</span> &#123;</span><br><span class="line">      <span class="attribute">position</span>: absolute;</span><br><span class="line">      <span class="attribute">width</span>: <span class="built_in">px2rem</span>(20);</span><br><span class="line">      <span class="attribute">height</span>: <span class="built_in">px2rem</span>(20);</span><br><span class="line">      <span class="attribute">border-radius</span>: <span class="number">50%</span>;</span><br><span class="line">      <span class="attribute">background</span>: <span class="number">#fff</span>;</span><br><span class="line">      <span class="attribute">border</span>: <span class="built_in">px2rem</span>(1) solid <span class="number">#ccc</span>;</span><br><span class="line">      <span class="attribute">box-shadow</span>: <span class="number">0</span> <span class="built_in">px2rem</span>(3) <span class="built_in">px2rem</span>(3) <span class="built_in">rgba</span>(0, 0, 0, .15);</span><br><span class="line">      @include center;</span><br><span class="line">      <span class="selector-class">.small-point</span> &#123;</span><br><span class="line">        <span class="attribute">position</span>: absolute;</span><br><span class="line">        <span class="attribute">width</span>: <span class="built_in">px2rem</span>(5);</span><br><span class="line">        <span class="attribute">height</span>: <span class="built_in">px2rem</span>(5);</span><br><span class="line">        <span class="attribute">border-radius</span>: <span class="number">50%</span>;</span><br><span class="line">        <span class="attribute">background</span>: <span class="number">#555555</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;自行开发的网页端电子书阅读器，本系列用于记录开发过程中的各种问题，本文为阅读器主界面中菜单栏的实现。&lt;/p&gt;
    
    </summary>
    
      <category term="文档" scheme="https://www.idkiro.xyz/categories/%E6%96%87%E6%A1%A3/"/>
    
    
      <category term="开发" scheme="https://www.idkiro.xyz/tags/%E5%BC%80%E5%8F%91/"/>
    
      <category term="阅读器" scheme="https://www.idkiro.xyz/tags/%E9%98%85%E8%AF%BB%E5%99%A8/"/>
    
      <category term="网页应用" scheme="https://www.idkiro.xyz/tags/%E7%BD%91%E9%A1%B5%E5%BA%94%E7%94%A8/"/>
    
  </entry>
  
  <entry>
    <title>Vue.js 入门学习笔记：电子书阅读器——标题栏</title>
    <link href="https://www.idkiro.xyz/2018/10/12/VuejsEbook8/"/>
    <id>https://www.idkiro.xyz/2018/10/12/VuejsEbook8/</id>
    <published>2018-10-12T09:59:25.000Z</published>
    <updated>2018-10-12T10:02:19.505Z</updated>
    
    <content type="html"><![CDATA[<p>自行开发的网页端电子书阅读器，本系列用于记录开发过程中的各种问题，本文为阅读器主界面中标题栏的实现。</p><a id="more"></a><h1 id="TitleBar-vue-标题栏"><a href="#TitleBar-vue-标题栏" class="headerlink" title="TitleBar.vue: 标题栏"></a>TitleBar.vue: 标题栏</h1><p>电子书阅读器主界面的标题栏的实现。</p><h3 id="Feature"><a href="#Feature" class="headerlink" title="Feature"></a>Feature</h3><ol><li>返回</li><li>添加/去除书签</li></ol><h3 id="TODO"><a href="#TODO" class="headerlink" title="TODO"></a>TODO</h3><ol><li>搜索</li></ol><h2 id="页面构成"><a href="#页面构成" class="headerlink" title="页面构成"></a>页面构成</h2><p>标题栏的构成非常简单，左边按钮组内现在只有一个返回功能，右边按钮组现在只有一个书签功能。点击返回按钮可以返回到书架，点击书签则可以添加或删去书签。通过判断该页面是否被标记书签，使用 <code>v-if</code> 和 <code>v-else</code> 决定是否渲染添加或删去书签的按钮，同一状态只会显示其中一个按钮。其中，返回按钮的功能实现在路由管理器中记录。</p><h2 id="书签"><a href="#书签" class="headerlink" title="书签"></a>书签</h2><p>添加书签要调用 epub.js 解析的电子书对象，所以调用方法都使用 <code>$emit</code> 组件进行事件的触发，让父组件监听到事件进而执行父组件的方法。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">addBookmark () &#123;</span><br><span class="line">  <span class="keyword">this</span>.$emit(<span class="string">'addBookmark'</span>)</span><br><span class="line">&#125;,</span><br><span class="line">removeBookmark () &#123;</span><br><span class="line">  <span class="keyword">this</span>.$emit(<span class="string">'removeBookmark'</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">title-bar</span> @<span class="attr">addBookmark</span>=<span class="string">"addBookmark"</span></span></span><br><span class="line"><span class="tag">            @<span class="attr">removeBookmark</span>=<span class="string">"removeBookmark"</span>&gt;</span><span class="tag">&lt;/<span class="name">title-bar</span>&gt;</span></span><br></pre></td></tr></table></figure><p>父组件的书签实现方法中的书签添加删除、书签已添加判定和标题栏组件有关。</p><p>加载定位完成后，可以用epub.js提供的 <code>rendition.currentLocation()</code> 方法来生成当前定位的相关信息，包括当前位置的开始和结束位置的 cfi(epub 的标记方法)。epub.js提供的 <code>display</code>方法的对象可以是 cfi，<code>display(cfi)</code> 可以直接显示该 cfi 所标记的电子书文本。那么书签就可以定义为一个数组，将要添加书签处的开始的 cfi 添加进数组中即可。 同样，为了保存用户的书签，需要将书签数组保存至 <code>localStorage</code>。因为 <code>cookie</code> 和 <code>localStorage</code> 都只保存字符串，所以需要使用 <code>JSON</code> 模块来进行转换。添加书签后，直接将书签的状态设置为已添加，此时添加书签按钮变成移除书签按钮。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">addBookmark () &#123;</span><br><span class="line">  <span class="keyword">let</span> currentCfi = <span class="keyword">this</span>.rendition.currentLocation()</span><br><span class="line">  currentCfi = currentCfi.start.cfi</span><br><span class="line">  <span class="keyword">let</span> currentContents = <span class="keyword">this</span>.rendition.getContents()</span><br><span class="line">  currentContents = currentContents[<span class="number">0</span>].document.title</span><br><span class="line">  <span class="keyword">let</span> currentBookmark = &#123;<span class="attr">cfi</span>: currentCfi, <span class="attr">title</span>: currentContents&#125;</span><br><span class="line">  <span class="keyword">if</span> (!<span class="keyword">this</span>.bookmarks) &#123;</span><br><span class="line">    <span class="keyword">this</span>.$store.commit(<span class="string">'setBookmarks'</span>, [])</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">this</span>.$store.commit(<span class="string">'pushBookmark'</span>, currentBookmark)</span><br><span class="line">  localStorage.setItem(localStorage.getItem(<span class="string">'defaultBook'</span>), <span class="built_in">JSON</span>.stringify(<span class="keyword">this</span>.bookmarks))</span><br><span class="line">  <span class="keyword">this</span>.$store.commit(<span class="string">'setBookMarked'</span>, <span class="literal">true</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>移除书签的方法则和添加书签相反，先读取书签，再对比书签中和当前页面 cfi 一致的项，调用方法进行数组元素的删除即可。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">removeBookmark () &#123;</span><br><span class="line">  <span class="keyword">let</span> currentCfi = <span class="keyword">this</span>.rendition.currentLocation()</span><br><span class="line">  currentCfi = currentCfi.start.cfi</span><br><span class="line">  <span class="keyword">this</span>.bookmarks.forEach(<span class="function">(<span class="params">item, index</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (item.cfi === currentCfi) &#123;</span><br><span class="line">      <span class="keyword">this</span>.$store.commit(<span class="string">'spliceBookmark'</span>, index)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">this</span>.bookmarks.length &lt; <span class="number">1</span>) &#123;</span><br><span class="line">    <span class="keyword">this</span>.$store.commit(<span class="string">'setBookmarks'</span>, <span class="literal">undefined</span>)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">this</span>.$store.commit(<span class="string">'setBookMarked'</span>, <span class="literal">false</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>每当页面改变时，都要进行当前页是否加入书签的判断，来决定显示添加书签的按钮还是显示移除书签的按钮。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">isBookMarked () &#123;</span><br><span class="line">  <span class="keyword">let</span> currentCfi = <span class="keyword">this</span>.rendition.currentLocation()</span><br><span class="line">  currentCfi = currentCfi.start.cfi</span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">this</span>.bookmarks) &#123;</span><br><span class="line">    <span class="keyword">this</span>.$store.commit(<span class="string">'setBookMarked'</span>, <span class="keyword">this</span>.bookmarks.some(<span class="function"><span class="params">item</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> item.cfi === currentCfi</span><br><span class="line">    &#125;))</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="切换动画"><a href="#切换动画" class="headerlink" title="切换动画"></a>切换动画</h2><p>标题栏的显示通过父组件控制存储状态进行控制。</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"title-wrapper"</span> <span class="attr">v-show</span>=<span class="string">"ifTitleAndMenuShow"</span>&gt;</span><span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><p>Vue 在更新 DOM 时可以添加过渡动画，最常用的过渡使用 CSS 过渡。</p><p>需要应用过渡动画的元素需要用 <code>transition</code> 标签的元素进行包裹，并且制定过渡动画的 <code>name</code> 属性。</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">transition</span> <span class="attr">name</span>=<span class="string">"slide-down"</span>&gt;</span><span class="tag">&lt;/<span class="name">transition</span>&gt;</span></span><br></pre></td></tr></table></figure><p>因为 <code>transition</code> 标签元素包裹着应用动画的元素，需要使用 <code>&amp;.</code> 定位到父元素。该 CSS 过渡动画定义了进入前、进入后的动画状态以及动画的形式。</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&amp;<span class="selector-class">.slide-down-enter</span>, &amp;<span class="selector-class">.slide-down-leave-to</span> &#123;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translate3d</span>(0, -100%, 0);</span><br><span class="line">&#125;</span><br><span class="line">&amp;<span class="selector-class">.slide-down-enter-to</span>, &amp;<span class="selector-class">.slide-down-leave</span> &#123;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translate3d</span>(0, 0, 0);</span><br><span class="line">&#125;</span><br><span class="line">&amp;<span class="selector-class">.slide-down-enter-active</span>, &amp;<span class="selector-class">.slide-down-leave-active</span> &#123;</span><br><span class="line">  <span class="attribute">transition</span>: all .<span class="number">3s</span> linear;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>标题栏在移入前和移除后都处于页面外，移入后则处于页面的最上方，动画使用直线移动即可。</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;自行开发的网页端电子书阅读器，本系列用于记录开发过程中的各种问题，本文为阅读器主界面中标题栏的实现。&lt;/p&gt;
    
    </summary>
    
      <category term="文档" scheme="https://www.idkiro.xyz/categories/%E6%96%87%E6%A1%A3/"/>
    
    
      <category term="开发" scheme="https://www.idkiro.xyz/tags/%E5%BC%80%E5%8F%91/"/>
    
      <category term="阅读器" scheme="https://www.idkiro.xyz/tags/%E9%98%85%E8%AF%BB%E5%99%A8/"/>
    
      <category term="网页应用" scheme="https://www.idkiro.xyz/tags/%E7%BD%91%E9%A1%B5%E5%BA%94%E7%94%A8/"/>
    
  </entry>
  
  <entry>
    <title>Vue.js 入门学习笔记：电子书阅读器——主界面</title>
    <link href="https://www.idkiro.xyz/2018/10/12/VuejsEbook7/"/>
    <id>https://www.idkiro.xyz/2018/10/12/VuejsEbook7/</id>
    <published>2018-10-12T07:41:22.000Z</published>
    <updated>2018-10-12T07:41:45.574Z</updated>
    
    <content type="html"><![CDATA[<p>自行开发的网页端电子书阅读器，本系列用于记录开发过程中的各种问题，本文为阅读器主界面的实现。</p><a id="more"></a><h1 id="Ebook-电子书阅读器主界面"><a href="#Ebook-电子书阅读器主界面" class="headerlink" title="Ebook: 电子书阅读器主界面"></a>Ebook: 电子书阅读器主界面</h1><p>电子书阅读器的阅读界面，标题栏和菜单栏在该组件导入进行调用，阅读功能的实现集中在该组件内。</p><h3 id="Feature"><a href="#Feature" class="headerlink" title="Feature"></a>Feature</h3><ol><li>可选主题的定义</li><li>可选字体大小的定义</li><li>电子书的显示、定位、书签等核心功能的实现</li></ol><h3 id="TODO"><a href="#TODO" class="headerlink" title="TODO"></a>TODO</h3><ol><li>翻页样式的设置</li><li>滑动翻页</li></ol><h2 id="页面构成"><a href="#页面构成" class="headerlink" title="页面构成"></a>页面构成</h2><p>阅读器页面的结构分为三层，由 CSS 的 <code>z-index</code> 属性来定义元素的层次。</p><p>最下面一层为阅读显示层，调用 epub.js 提供的属性和方法来进行阅读功能的实现。</p><p>中间一层为蒙版层，用于检测用户在阅读时的点击事件，中间为切换标题栏和菜单栏的显示状态，左右分别为上一页和下一页。</p><p>最上面一层为标题栏和菜单栏的显示层，标题栏和菜单栏通过调用子组件进行渲染，通过绑定和监听与子组件进行数据的传递。</p><h2 id="阅读功能"><a href="#阅读功能" class="headerlink" title="阅读功能"></a>阅读功能</h2><p><code>showEpub</code> 方法为阅读方法的实现部分，各部分的操作已做注释。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">showEpub () &#123;</span><br><span class="line">  <span class="comment">// 重置部分状态为不可用</span></span><br><span class="line">  <span class="keyword">this</span>.$store.commit(<span class="string">'setBookAvailable'</span>, <span class="literal">false</span>)</span><br><span class="line">  <span class="comment">// 从本地存储记录里加载上次选择的图书</span></span><br><span class="line">  <span class="keyword">this</span>.book = <span class="keyword">new</span> Epub(localStorage.getItem(<span class="string">'defaultBook'</span>))</span><br><span class="line">  <span class="comment">// 获取 Rendition，定义显示区域</span></span><br><span class="line">  <span class="keyword">this</span>.rendition = <span class="keyword">this</span>.book.renderTo(<span class="string">'read'</span>, &#123;</span><br><span class="line">    width: <span class="built_in">window</span>.innerWidth,</span><br><span class="line">    height: <span class="built_in">window</span>.innerHeight</span><br><span class="line">  &#125;)</span><br><span class="line">  <span class="comment">// 显示电子书，如该电子书阅读过，则直接加载上一次阅读到的位置</span></span><br><span class="line">  <span class="keyword">if</span> (localStorage.getItem(localStorage.getItem(<span class="string">'defaultBook'</span>) + <span class="string">'bookReadLocation'</span>)) &#123;</span><br><span class="line">    <span class="keyword">this</span>.rendition.display(localStorage.getItem(localStorage.getItem(<span class="string">'defaultBook'</span>) + <span class="string">'bookReadLocation'</span>))</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">this</span>.rendition.display()</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// 设置字体，如本地存储中保存有更改过的默认设置，则加载</span></span><br><span class="line">  <span class="keyword">if</span> (localStorage.getItem(<span class="string">'defaultFontSize'</span>)) &#123;</span><br><span class="line">    <span class="keyword">this</span>.$store.commit(<span class="string">'setDefaultFontSize'</span>, <span class="built_in">parseInt</span>(localStorage.getItem(<span class="string">'defaultFontSize'</span>)))</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">this</span>.setFontSize(<span class="keyword">this</span>.defaultFontSize)</span><br><span class="line">  <span class="comment">// 注册和加载主题，如本地存储中保存有更改过的默认设置，则加载</span></span><br><span class="line">  <span class="keyword">this</span>.themes = <span class="keyword">this</span>.rendition.themes</span><br><span class="line">  <span class="keyword">this</span>.registerTheme()</span><br><span class="line">  <span class="keyword">if</span> (localStorage.getItem(<span class="string">'defaultTheme'</span>)) &#123;</span><br><span class="line">    <span class="keyword">this</span>.$store.commit(<span class="string">'setDefaultTheme'</span>, <span class="built_in">parseInt</span>(localStorage.getItem(<span class="string">'defaultTheme'</span>)))</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">this</span>.setTheme(<span class="keyword">this</span>.defaultTheme)</span><br><span class="line">  <span class="comment">// 加载目录和书签并开始生成定位</span></span><br><span class="line">  <span class="keyword">this</span>.book.ready.then(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// 保存电子书的封面</span></span><br><span class="line">    <span class="keyword">this</span>.book.loaded.metadata.then(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">this</span>.book.archive.getBase64(<span class="keyword">this</span>.book.cover).then(<span class="function"><span class="params">value</span> =&gt;</span> &#123;</span><br><span class="line">        localStorage.setItem(localStorage.getItem(<span class="string">'defaultBook'</span>) + <span class="string">'cover'</span>, value)</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="keyword">this</span>.$store.commit(<span class="string">'openNavigation'</span>, <span class="keyword">this</span>.book.navigation)</span><br><span class="line">    <span class="keyword">if</span> (localStorage.getItem(localStorage.getItem(<span class="string">'defaultBook'</span>))) &#123;</span><br><span class="line">      <span class="keyword">this</span>.$store.commit(<span class="string">'setBookmarks'</span>, <span class="built_in">JSON</span>.parse(localStorage.getItem(localStorage.getItem(<span class="string">'defaultBook'</span>))))</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">this</span>.$store.commit(<span class="string">'setBookmarks'</span>, <span class="literal">undefined</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.book.locations.generate(<span class="number">1650</span>)</span><br><span class="line">  &#125;).then(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// 加载定位并将进度条、书签等功能启用</span></span><br><span class="line">    <span class="keyword">this</span>.location = <span class="keyword">this</span>.book.locations</span><br><span class="line">    <span class="keyword">this</span>.$store.commit(<span class="string">'setBookAvailable'</span>, <span class="literal">true</span>)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>因为 epub.js 解析电子书有一定的顺序要求，所以需要使用 <code>Promise.prototype.then()</code> 方法来规定顺序，当 <code>Promise</code> 为成功时才执行后续的步骤。电子书加载时需要加载完成才允许生成目录和定位，当资源加载后才允许获取资源中的封面。</p><p>在上传书籍后直接打开书籍也是为了加载书籍后获取书籍的封面图片并保存供书架使用。当然这部分也可以在书架中实现，只要加载后不显示电子书即可，再使用 <code>foreach</code> 遍历 <code>filelist</code> 获取每本书的封面。</p><h2 id="蒙版"><a href="#蒙版" class="headerlink" title="蒙版"></a>蒙版</h2><p>蒙版部分使用绝对位置使其覆盖在整个页面，并用 <code>flex</code> 布局分割为三个区域，点击三个区域时分别触发相应的方法。</p><p>翻页功能较为简单，直接调用 epub.js 提供的方法即可。为了实现点击后隐藏标题栏、菜单栏等的功能，调用 <code>hideTitleAndMenu</code> 方法，最后调用 <code>pageChanged</code> 方法来进行页面数据的更新，用于检测当前页是否被加入书签。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">prevpage () &#123;</span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">this</span>.rendition) &#123;</span><br><span class="line">    <span class="keyword">this</span>.rendition.prev()</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">this</span>.hideTitleAndMenu()</span><br><span class="line">  <span class="keyword">this</span>.pageChanged()</span><br><span class="line">&#125;,</span><br><span class="line">nextpage () &#123;</span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">this</span>.rendition) &#123;</span><br><span class="line">    <span class="keyword">this</span>.rendition.next()</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">this</span>.hideTitleAndMenu()</span><br><span class="line">  <span class="keyword">this</span>.pageChanged()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">hideTitleAndMenu () &#123;</span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">this</span>.ifTitleAndMenuShow) &#123;</span><br><span class="line">    <span class="keyword">this</span>.$store.commit(<span class="string">'setTitleAndMenuShow'</span>, <span class="literal">false</span>)</span><br><span class="line">    <span class="keyword">this</span>.$refs.menuBar.hideSetting()</span><br><span class="line">    <span class="keyword">this</span>.$refs.menuBar.hideContent()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>点击蒙版的中间位置调用切换菜单栏和标题栏显示状态的方法，因为设置栏由菜单栏呼出，所以要一同隐藏。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">toggleTitleAndMenu () &#123;</span><br><span class="line">  <span class="keyword">this</span>.$store.commit(<span class="string">'toggleTitleAndMenu'</span>)</span><br><span class="line">  <span class="comment">// 如果菜单栏隐藏，那设置栏也一同隐藏</span></span><br><span class="line">  <span class="keyword">if</span> (!<span class="keyword">this</span>.ifTitleAndMenuShow) &#123;</span><br><span class="line">    <span class="keyword">this</span>.$refs.menuBar.hideSetting()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>hideSetting</code> 和 <code>hideContent</code> 方法均在子组件中，调用子组件的方法不需要进行绑定或者监听。</p><h2 id="主题和字体"><a href="#主题和字体" class="headerlink" title="主题和字体"></a>主题和字体</h2><p>epub.js 支持主题的更换，按照规定格式定义对象即可：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  name: <span class="string">'默认'</span>,</span><br><span class="line">  style: &#123;</span><br><span class="line">    body: &#123;</span><br><span class="line">      <span class="string">'color'</span>: <span class="string">'#000'</span>, <span class="string">'background'</span>: <span class="string">'#fff'</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>使用主题前需要对主题进行注册，使用遍历便可以完成。设置主题直接调用 <code>select</code> 方法即可。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">registerTheme () &#123;</span><br><span class="line">  <span class="keyword">this</span>.themeList.forEach(<span class="function"><span class="params">themes</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">this</span>.themes.register(themes.name, themes.style)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;,</span><br><span class="line">setTheme (index) &#123;</span><br><span class="line">  <span class="keyword">this</span>.themes.select(<span class="keyword">this</span>.themeList[index].name)</span><br><span class="line">  <span class="keyword">this</span>.$store.commit(<span class="string">'setDefaultTheme'</span>, index)</span><br><span class="line">  localStorage.setItem(<span class="string">'defaultTheme'</span>, index)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>字体在 epub.js 中属于主题的一部分，可以通过 <code>fontSize</code> 方法设置字体大小。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">setFontSize (fontSize) &#123;</span><br><span class="line">  <span class="keyword">this</span>.$store.commit(<span class="string">'setDefaultFontSize'</span>, fontSize)</span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">this</span>.themes) &#123;</span><br><span class="line">    <span class="keyword">this</span>.themes.fontSize(fontSize + <span class="string">'px'</span>)</span><br><span class="line">  &#125;</span><br><span class="line">  localStorage.setItem(<span class="string">'defaultFontSize'</span>, fontSize)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>为了保存用户的偏好，将这些设置数据全部保存在 <code>localStorage</code> 中。</p><h2 id="其他功能"><a href="#其他功能" class="headerlink" title="其他功能"></a>其他功能</h2><p>书签、定位、跳转、设置字体和主题等功能虽然也在本组件内实现，但是实际调用在子组件内，将在子组件的笔记中进行记录。</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;自行开发的网页端电子书阅读器，本系列用于记录开发过程中的各种问题，本文为阅读器主界面的实现。&lt;/p&gt;
    
    </summary>
    
      <category term="文档" scheme="https://www.idkiro.xyz/categories/%E6%96%87%E6%A1%A3/"/>
    
    
      <category term="开发" scheme="https://www.idkiro.xyz/tags/%E5%BC%80%E5%8F%91/"/>
    
      <category term="阅读器" scheme="https://www.idkiro.xyz/tags/%E9%98%85%E8%AF%BB%E5%99%A8/"/>
    
      <category term="网页应用" scheme="https://www.idkiro.xyz/tags/%E7%BD%91%E9%A1%B5%E5%BA%94%E7%94%A8/"/>
    
  </entry>
  
  <entry>
    <title>Vue.js 入门学习笔记：电子书阅读器——状态管理</title>
    <link href="https://www.idkiro.xyz/2018/10/12/VuejsEbook6/"/>
    <id>https://www.idkiro.xyz/2018/10/12/VuejsEbook6/</id>
    <published>2018-10-12T05:27:22.000Z</published>
    <updated>2018-10-12T05:26:27.432Z</updated>
    
    <content type="html"><![CDATA[<p>自行开发的网页端电子书阅读器，本系列用于记录开发过程中的各种问题，本文为 Vue 项目的状态管理。</p><a id="more"></a><h1 id="状态管理"><a href="#状态管理" class="headerlink" title="状态管理"></a>状态管理</h1><p>Vuex 是一个专为 Vue.js 应用程序开发的状态管理模式。</p><p><code>store</code> 文件夹下的 <code>index.js</code> 文件为状态管理组件的入口文件：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Vue <span class="keyword">from</span> <span class="string">'vue'</span></span><br><span class="line"><span class="keyword">import</span> Vuex <span class="keyword">from</span> <span class="string">'vuex'</span></span><br><span class="line"><span class="keyword">import</span> state <span class="keyword">from</span> <span class="string">'./state'</span></span><br><span class="line"><span class="keyword">import</span> getters <span class="keyword">from</span> <span class="string">'./getters'</span></span><br><span class="line"><span class="keyword">import</span> mutations <span class="keyword">from</span> <span class="string">'./mutations'</span></span><br><span class="line"></span><br><span class="line">Vue.use(Vuex)</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">new</span> Vuex.Store(&#123;</span><br><span class="line">  state,</span><br><span class="line">  getters,</span><br><span class="line">  mutations</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>状态管理组件中需要导入并组装 <code>state</code>、<code>getters</code> 和<code>mutations</code> 三个模块：</p><ul><li><code>state</code> 记录了应用大部分的状态，一些严格属于单个组件的状态不需要放入 Vuex</li><li><code>getters</code> 获取 state 的派生状态，包含派生状态的方法或属性</li><li><code>mutations</code> 更改 store 中的状态，包含改变状态的方法</li></ul><p>除此之外常用的还有 <code>actions</code> 和 <code>modules</code>：</p><ul><li><code>actions</code> 提交 mutation，不直接变更状态，处理异步操作</li><li><code>modules</code> store 分割成模块，存放在文件夹 <code>modules</code> 中</li></ul><h2 id="State"><a href="#State" class="headerlink" title="State"></a>State</h2><p><code>state.js</code> 中包含了供多个组件使用的状态：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> state = &#123;</span><br><span class="line">  bookList: [],</span><br><span class="line">  bookAvailable: <span class="literal">false</span>,</span><br><span class="line">  ifTitleAndMenuShow: <span class="literal">false</span>,</span><br><span class="line">  ifBookMarked: <span class="literal">false</span>,</span><br><span class="line">  navigation: &#123;&#125;,</span><br><span class="line">  bookCurrentLocation: <span class="number">0</span>,</span><br><span class="line">  bookmarks: <span class="literal">undefined</span>,</span><br><span class="line">  defaultFontSize: <span class="number">16</span>,</span><br><span class="line">  defaultTheme: <span class="number">0</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> state</span><br></pre></td></tr></table></figure><p>组件可以通过 <code>this.$store</code> 访问到 <code>store</code> 实例，使用 <code>this.$store.state</code> 获取Vuex中的状态。组件获取 <code>store</code> 实例中的状态时，一般使用计算属性，<code>TitleBar.vue</code> 就存在以下计算属性：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">computed: &#123;</span><br><span class="line">  ifTitleAndMenuShow () &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.$store.state.ifTitleAndMenuShow</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>计算属性会基于依赖进行缓存，只在相关依赖发生改变时它们才会重新求值，可以防止每次渲染都进行调用，减小开销。通过计算属性，获取标题栏显示状态就不需要获取 <code>$store.state.ifTitleAndMenuShow</code>，获取计算属性 <code>ifTitleAndMenuShow</code> 即可。</p><h2 id="Getter"><a href="#Getter" class="headerlink" title="Getter"></a>Getter</h2><p>为了使得一些 <code>state</code> 中的状态的派生状态可以复用，便在 <code>store</code> 中定义 <code>getter</code>。<code>getter</code> 的返回值和计算属性一样，会根据它的依赖被缓存起来，且只有当它的依赖值发生了改变才会被重新计算。比如本项目从 <code>state</code> 中的 <code>bookList</code> 派生出去除重复书签的 <code>bookList</code>，<code>getter</code> 接受 state 作为其第一个参数：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> getters = &#123;</span><br><span class="line">  bookList: <span class="function"><span class="params">state</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">Array</span>.from(<span class="keyword">new</span> <span class="built_in">Set</span>(state.bookList))</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> getters</span><br></pre></td></tr></table></figure><p><code>Guide.vue</code> 中便使用 <code>this.$store.getters.bookList</code> 获取了派生出的去重 <code>bookList</code>：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">computed: &#123;</span><br><span class="line">  bookList () &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.$store.getters.bookList</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="Mutation"><a href="#Mutation" class="headerlink" title="Mutation"></a>Mutation</h2><p>Vue 不推荐直接改变 <code>store</code> 中的状态，需要改变 <code>store</code> 中的状态只能显式地提交 <code>mutation</code>：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">store.commit(<span class="string">'handler'</span>)</span><br></pre></td></tr></table></figure><p>其中 <code>handler</code> 表示 <code>mutation</code> 的回调函数，比如本项目中用于改变电子书加载状态的 回调函数：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> mutations = &#123;</span><br><span class="line">  setBookAvailable (state, val) &#123;</span><br><span class="line">    state.bookAvailable = val</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> mutations</span><br></pre></td></tr></table></figure><p><code>Ebook.vue</code> 中提交 <code>mutation</code>：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">this</span>.$store.commit(<span class="string">'setBookAvailable'</span>, <span class="literal">false</span>)</span><br></pre></td></tr></table></figure><p>提交 mutation 时会接受 <code>state</code> 作为第一个参数，向 <code>store.commit</code> 传入额外的参数称为载荷，其一般为对象，<code>setBookAvailable (state, val)</code> 中的 <code>val</code> 即是该 <code>mutation</code> 的载荷。</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;自行开发的网页端电子书阅读器，本系列用于记录开发过程中的各种问题，本文为 Vue 项目的状态管理。&lt;/p&gt;
    
    </summary>
    
      <category term="文档" scheme="https://www.idkiro.xyz/categories/%E6%96%87%E6%A1%A3/"/>
    
    
      <category term="开发" scheme="https://www.idkiro.xyz/tags/%E5%BC%80%E5%8F%91/"/>
    
      <category term="阅读器" scheme="https://www.idkiro.xyz/tags/%E9%98%85%E8%AF%BB%E5%99%A8/"/>
    
      <category term="网页应用" scheme="https://www.idkiro.xyz/tags/%E7%BD%91%E9%A1%B5%E5%BA%94%E7%94%A8/"/>
    
  </entry>
  
  <entry>
    <title>Vue.js 入门学习笔记：电子书阅读器——路由管理器</title>
    <link href="https://www.idkiro.xyz/2018/10/12/VuejsEbook5/"/>
    <id>https://www.idkiro.xyz/2018/10/12/VuejsEbook5/</id>
    <published>2018-10-12T05:23:22.000Z</published>
    <updated>2018-10-12T05:25:31.184Z</updated>
    
    <content type="html"><![CDATA[<p>自行开发的网页端电子书阅读器，本系列用于记录开发过程中的各种问题，本文为 Vue 项目的路由管理器。</p><a id="more"></a><h1 id="路由管理器简述"><a href="#路由管理器简述" class="headerlink" title="路由管理器简述"></a>路由管理器简述</h1><p>Vue Router 是 Vue.js 官方的路由管理器。</p><p><code>router</code> 文件夹下的 <code>index.js</code> 文件为路由管理器组件的入口文件：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Vue <span class="keyword">from</span> <span class="string">'vue'</span></span><br><span class="line"><span class="keyword">import</span> Router <span class="keyword">from</span> <span class="string">'vue-router'</span></span><br><span class="line"><span class="keyword">import</span> Guide <span class="keyword">from</span> <span class="string">'@/components/Guide'</span></span><br><span class="line"><span class="keyword">import</span> Ebook <span class="keyword">from</span> <span class="string">'@/components/Ebook'</span></span><br><span class="line"></span><br><span class="line">Vue.use(Router)</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">new</span> Router(&#123;</span><br><span class="line">  routes: [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="comment">// 路由指向路径</span></span><br><span class="line">      path: <span class="string">'/'</span>,</span><br><span class="line">      <span class="comment">// 路由名称，可以不命名</span></span><br><span class="line">      name: <span class="string">'Guide'</span>,</span><br><span class="line">      <span class="comment">// 路由指向组件</span></span><br><span class="line">      component: Guide</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      path: <span class="string">'/ebook'</span>,</span><br><span class="line">      name: <span class="string">'Ebook'</span>,</span><br><span class="line">      component: Ebook</span><br><span class="line">    &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>创建路由组件实例时，需要给每个路由对象指定相对于主页的路径和加载的页面组件。本项目的根路径为书架，加载Guide组件，<code>ebook</code> 路径为阅读页面，加载 <code>Ebook</code> 组件，由路由管理器控制加载的页面组件也需要先使用 <code>import</code> 进行导入。</p><h2 id="项目中的路由使用"><a href="#项目中的路由使用" class="headerlink" title="项目中的路由使用"></a>项目中的路由使用</h2><p>本项目涉及到路由的部分较少，分别为选择书籍后转到阅读页面(Ebook组件)，在标题栏中点击返回按钮返回书架页面(Guide组件).</p><p><code>TitleBar.vue</code> 中：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">back () &#123;</span><br><span class="line">    <span class="keyword">this</span>.$store.commit(<span class="string">'setTitleAndMenuShow'</span>, <span class="literal">false</span>)</span><br><span class="line">    <span class="keyword">this</span>.$router.push(<span class="string">'/'</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>在返回书架页面前，这里将标题栏和菜单栏的状态设置为不显示，防止下次进入阅读页面时菜单栏默认显示。</p><p><code>Guide.vue</code> 中：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">openBook (index) &#123;</span><br><span class="line">    localStorage.setItem(<span class="string">'defaultBook'</span>, <span class="string">'/static/library/'</span> + <span class="keyword">this</span>.bookList[index] + <span class="string">'.epub'</span>)</span><br><span class="line">    <span class="keyword">this</span>.$router.push(<span class="string">'/ebook'</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>router.push()</code> 属于编程式的导航：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">router.push(location, onComplete?, onAbort?)</span><br></pre></td></tr></table></figure><p><code>location</code> 参数可以是直接是一个字符串路径，也可以是一个对象，对象中指定 <code>path</code> 即可进行链接(params 会被忽略)，如果在路由实例中进行了路由的命名，可以指定 <code>name</code> 属性进行该名称绑定链接的访问：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 字符串</span></span><br><span class="line">router.push(<span class="string">'home'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 对象</span></span><br><span class="line">router.push(&#123; <span class="attr">path</span>: <span class="string">'home'</span> &#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 命名的路由</span></span><br><span class="line">router.push(&#123; <span class="attr">name</span>: <span class="string">'user'</span> &#125;&#125;)</span><br></pre></td></tr></table></figure><p><code>router.go()</code> 很常用的编程式的导航方法：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">router.go(n)</span><br></pre></td></tr></table></figure><p>n 是一个整数，意思是在 history 记录中向前或者后退多少步。</p><p>相对应的，使用 <code>&lt;router-link&gt;</code> 创建 a 标签(href=”#”)来定义导航链接的方法就是声明式:</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">router-link</span> <span class="attr">to</span>=<span class="string">"/bar"</span>&gt;</span>Go to Bar<span class="tag">&lt;/<span class="name">router-link</span>&gt;</span></span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;自行开发的网页端电子书阅读器，本系列用于记录开发过程中的各种问题，本文为 Vue 项目的路由管理器。&lt;/p&gt;
    
    </summary>
    
      <category term="文档" scheme="https://www.idkiro.xyz/categories/%E6%96%87%E6%A1%A3/"/>
    
    
      <category term="开发" scheme="https://www.idkiro.xyz/tags/%E5%BC%80%E5%8F%91/"/>
    
      <category term="阅读器" scheme="https://www.idkiro.xyz/tags/%E9%98%85%E8%AF%BB%E5%99%A8/"/>
    
      <category term="网页应用" scheme="https://www.idkiro.xyz/tags/%E7%BD%91%E9%A1%B5%E5%BA%94%E7%94%A8/"/>
    
  </entry>
  
  <entry>
    <title>Vue.js 入门学习笔记：电子书阅读器——导入库、组件和全局样式</title>
    <link href="https://www.idkiro.xyz/2018/10/12/VuejsEbook4/"/>
    <id>https://www.idkiro.xyz/2018/10/12/VuejsEbook4/</id>
    <published>2018-10-12T05:21:22.000Z</published>
    <updated>2018-10-12T05:24:33.976Z</updated>
    
    <content type="html"><![CDATA[<p>自行开发的网页端电子书阅读器，本系列用于记录开发过程中的各种问题，本文为 Vue 项目的导入库、组件和全局样式。</p><a id="more"></a><h1 id="导入库、组件和全局样式"><a href="#导入库、组件和全局样式" class="headerlink" title="导入库、组件和全局样式"></a>导入库、组件和全局样式</h1><p>为了在项目中启用之前准备的库、组件和全局样式，需要编辑 <code>main.js</code> ，也就是项目入口文件。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Vue <span class="keyword">from</span> <span class="string">'vue'</span></span><br><span class="line"><span class="keyword">import</span> App <span class="keyword">from</span> <span class="string">'./App'</span></span><br><span class="line"><span class="keyword">import</span> router <span class="keyword">from</span> <span class="string">'./router'</span></span><br><span class="line"><span class="keyword">import</span> store <span class="keyword">from</span> <span class="string">'./store'</span></span><br><span class="line"><span class="keyword">import</span> vuescroll <span class="keyword">from</span> <span class="string">'vuescroll'</span></span><br><span class="line"><span class="keyword">import</span> ElementUI <span class="keyword">from</span> <span class="string">'element-ui'</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">'vuescroll/dist/vuescroll.css'</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">'element-ui/lib/theme-chalk/index.css'</span></span><br><span class="line"><span class="comment">// 导入全局样式</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">'@/assets/styles/icon.css'</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">'@/assets/styles/global.scss'</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">'@/assets/styles/theme/index.css'</span></span><br><span class="line"></span><br><span class="line">Vue.config.productionTip = <span class="literal">false</span></span><br><span class="line">Vue.use(vuescroll)</span><br><span class="line">Vue.use(ElementUI)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 设置滚动条的默认颜色</span></span><br><span class="line">Vue.prototype.$vuescrollConfig = &#123;</span><br><span class="line">  bar: &#123;</span><br><span class="line">    background: <span class="string">'#ccc'</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* eslint-disable no-new */</span></span><br><span class="line"><span class="keyword">new</span> Vue(&#123;</span><br><span class="line">  el: <span class="string">'#app'</span>,</span><br><span class="line">  router,</span><br><span class="line">  store,</span><br><span class="line">  components: &#123; App &#125;,</span><br><span class="line">  template: <span class="string">'&lt;App/&gt;'</span>,</span><br><span class="line">  render: <span class="function"><span class="params">h</span> =&gt;</span> h(App)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><ul><li><code>import</code>: 导入库和样式表</li><li><code>Vue.use()</code>: 从库中注册组件供项目使用</li><li><code>new Vue()</code>: 使用包含的组件创建实例，并将模块进行组装</li></ul><p><code>/* eslint-disable no-new */</code> 可以让直接使用 new 创建实例绕过规则检测。</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;自行开发的网页端电子书阅读器，本系列用于记录开发过程中的各种问题，本文为 Vue 项目的导入库、组件和全局样式。&lt;/p&gt;
    
    </summary>
    
      <category term="文档" scheme="https://www.idkiro.xyz/categories/%E6%96%87%E6%A1%A3/"/>
    
    
      <category term="开发" scheme="https://www.idkiro.xyz/tags/%E5%BC%80%E5%8F%91/"/>
    
      <category term="阅读器" scheme="https://www.idkiro.xyz/tags/%E9%98%85%E8%AF%BB%E5%99%A8/"/>
    
      <category term="网页应用" scheme="https://www.idkiro.xyz/tags/%E7%BD%91%E9%A1%B5%E5%BA%94%E7%94%A8/"/>
    
  </entry>
  
  <entry>
    <title>Vue.js 入门学习笔记：电子书阅读器——项目全局样式</title>
    <link href="https://www.idkiro.xyz/2018/10/12/VuejsEbook3/"/>
    <id>https://www.idkiro.xyz/2018/10/12/VuejsEbook3/</id>
    <published>2018-10-12T05:18:22.000Z</published>
    <updated>2018-10-12T05:24:43.526Z</updated>
    
    <content type="html"><![CDATA[<p>自行开发的网页端电子书阅读器，本系列用于记录开发过程中的各种问题，本文为 Vue 项目的项目全局样式。</p><a id="more"></a><h1 id="项目全局样式"><a href="#项目全局样式" class="headerlink" title="项目全局样式"></a>项目全局样式</h1><h2 id="设置全局样式"><a href="#设置全局样式" class="headerlink" title="设置全局样式"></a>设置全局样式</h2><p>本项目将样式文件夹 <code>styles</code> 全部放在<code>\src\asset\</code> 中：</p><img src="/2018/10/12/VuejsEbook3/4.png"><h3 id="图标样式"><a href="#图标样式" class="headerlink" title="图标样式"></a>图标样式</h3><p>其中 <code>icon.css</code> 对应之前下载的图标组件的 <code>style.css</code>， <code>fonts</code> 则对应之前下载的图标组件的 <code>fonts</code>。</p><h3 id="全局样式"><a href="#全局样式" class="headerlink" title="全局样式"></a>全局样式</h3><p><code>reset.scss</code> 文件用于减少浏览器的不同导致的样式差别，直接在复制一份到该目录下即可：</p><p><a href="https://meyerweb.com/eric/tools/css/reset/" target="_blank" rel="noopener">https://meyerweb.com/eric/tools/css/reset/</a></p><p>这里为了字体的美观在 <code>reset.scss</code> 文件中添加了以下一段代码：</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">html</span>, <span class="selector-tag">body</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">font-family</span>: <span class="string">"Helvetica Neue"</span>,Helvetica,<span class="string">"PingFang SC"</span>,<span class="string">"Hiragino Sans GB"</span>,<span class="string">"Microsoft YaHei"</span>,<span class="string">"å¾®è½¯é›…é»‘"</span>,Arial,sans-serif;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>使用的 <code>font-family</code> 为 element-ui 推荐的字体列表：</p><p><a href="http://element-cn.eleme.io/#/zh-CN/component/typography" target="_blank" rel="noopener">http://element-cn.eleme.io/#/zh-CN/component/typography</a></p><p><code>global.scss</code> 则为全局可用的样式表：</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 导入 `reset.scss` */</span></span><br><span class="line">@<span class="keyword">import</span> <span class="string">"reset"</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 定义 `px2rem` 函数 */</span></span><br><span class="line">$fontSize : 36;</span><br><span class="line">@<span class="keyword">function</span> px2rem($px) &#123;</span><br><span class="line">  @<span class="keyword">return</span> ($px / $fontSize) + rem;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 定义居中样式缩写 */</span></span><br><span class="line">@<span class="keyword">mixin</span> center() &#123;</span><br><span class="line">  <span class="selector-tag">display</span>: <span class="selector-tag">flex</span>;</span><br><span class="line">  <span class="selector-tag">justify-content</span>: <span class="selector-tag">center</span>;</span><br><span class="line">  <span class="selector-tag">align-items</span>: <span class="selector-tag">center</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 设置图标默认样式 */</span></span><br><span class="line"><span class="selector-class">.icon</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#555555</span>;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="built_in">px2rem</span>(20);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>其中 <code>px2rem</code> 函数用于将 px 单位的大小转换为 rem 单位（1rem = 1倍根节点字体大小）的大小，查看本项目的 <code>App.vue</code> 可以看到增加了以下一段代码：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 动态调整根节点字体</span></span><br><span class="line"><span class="built_in">document</span>.addEventListener(<span class="string">'DOMContentLoaded'</span>, () =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> html = <span class="built_in">document</span>.querySelector(<span class="string">'html'</span>)</span><br><span class="line">  <span class="keyword">let</span> fontSize = <span class="built_in">window</span>.innerWidth / <span class="number">10</span></span><br><span class="line">  fontSize = fontSize &gt; <span class="number">48</span> ? <span class="number">48</span> : fontSize</span><br><span class="line">  html.style.fontSize = fontSize + <span class="string">'px'</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>这段代码是为了根据屏幕的宽度动态调整根节点字体的大小，让不同屏幕宽度的设备都有较好的字体显示效果。但是其他元素如果直接用 px 为单位进行样式的设置，那么就会使得字体和元素的大小不成比例，所以在全局样式中提供了 <code>px2rem</code> 函数，使得样式和字体有较好的一致性。</p><h3 id="element-ui-主题"><a href="#element-ui-主题" class="headerlink" title="element-ui 主题"></a>element-ui 主题</h3><p>element-ui 默认主题的颜色为蓝色，为了和项目颜色一致，需要改变 element-ui 主题的颜色，官方提供了在线工具：</p><p><a href="https://elementui.github.io/theme-chalk-preview/#/zh-CN" target="_blank" rel="noopener">https://elementui.github.io/theme-chalk-preview/#/zh-CN</a></p><p>将下载的压缩包解压后得到的文件放在 <code>theme</code> 文件夹即可。</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;自行开发的网页端电子书阅读器，本系列用于记录开发过程中的各种问题，本文为 Vue 项目的项目全局样式。&lt;/p&gt;
    
    </summary>
    
      <category term="文档" scheme="https://www.idkiro.xyz/categories/%E6%96%87%E6%A1%A3/"/>
    
    
      <category term="开发" scheme="https://www.idkiro.xyz/tags/%E5%BC%80%E5%8F%91/"/>
    
      <category term="阅读器" scheme="https://www.idkiro.xyz/tags/%E9%98%85%E8%AF%BB%E5%99%A8/"/>
    
      <category term="网页应用" scheme="https://www.idkiro.xyz/tags/%E7%BD%91%E9%A1%B5%E5%BA%94%E7%94%A8/"/>
    
  </entry>
  
  <entry>
    <title>Vue.js 入门学习笔记：电子书阅读器——Vue 项目简述</title>
    <link href="https://www.idkiro.xyz/2018/10/12/VuejsEbook2/"/>
    <id>https://www.idkiro.xyz/2018/10/12/VuejsEbook2/</id>
    <published>2018-10-12T04:58:22.000Z</published>
    <updated>2018-10-12T05:11:15.747Z</updated>
    
    <content type="html"><![CDATA[<p>自行开发的网页端电子书阅读器，本系列用于记录开发过程中的各种问题，本文为 Vue 项目的基本知识。</p><a id="more"></a><h1 id="Vue-项目简述"><a href="#Vue-项目简述" class="headerlink" title="Vue 项目简述"></a>Vue 项目简述</h1><p>首先了解下Vue项目的一些基本知识。</p><h2 id="项目的结构"><a href="#项目的结构" class="headerlink" title="项目的结构"></a>项目的结构</h2><p>先看一下项目的文件目录，知道哪些文件和文件夹是供我们编辑的：</p><img src="/2018/10/12/VuejsEbook2/1.png"><h3 id="文件夹"><a href="#文件夹" class="headerlink" title="文件夹"></a>文件夹</h3><ul><li><code>src</code> 文件夹，包含了整个应用所有的代码源文件，是整个项目最重要的部分</li><li><code>config</code> 文件夹，项目参数</li><li><code>static</code> 静态资源文件夹</li></ul><p>因为 <code>src</code> 是程序的本体，所以讲一下里面的文件结构：</p><img src="/2018/10/12/VuejsEbook2/3.png"><p><code>asset</code> 为资源文件夹，保存图片这类供程序调用的文件，也可以保存一些全局有效的样式。</p><p><code>components</code> 为组件文件夹，Vue 有一个很重要的概念————组件，组件可以和其他语言的类或者函数做类比，它一方面可以方便代码的复用，另一方面可以减小单文件的长度，让代码更简洁。</p><p><code>router</code> 为路由文件夹，对应 <code>vue-router</code> 库，<code>vue-router</code> 用于将各个页面（组件）连接起来，提供在不同的页面（组件）间切换的功能。</p><p>如果按照默认配置，那么文件夹里没有 <code>store</code> 这个文件夹，该文件夹需要安装 <code>Vuex</code> 后才能使用。<code>Vuex</code> 用于管理应用的状态，可以理解成将程序的状态相关的变量集中存储于 <code>state</code> 文件夹的 js 文件中。</p><h3 id="文件"><a href="#文件" class="headerlink" title="文件"></a>文件</h3><p><strong>根目录文件：</strong></p><ul><li><code>index.html</code> 主页面文件，由Vue来渲染</li><li><code>package.json</code> 项目所使用的依赖包</li></ul><p><strong><code>src</code> 文件夹下文件：</strong></p><ul><li><code>main.js</code> 入口文件，初始化实例，导入全局可用的模块</li><li><code>App.vue</code> 总组件文件，调用组件来进行页面的渲染，可以在此处定义所有页面共用的脚本和样式</li></ul><p><strong><code>config</code> 文件夹下文件：</strong></p><ul><li><code>index.js</code> index页面的参数</li></ul><h2 id="文件调用简述"><a href="#文件调用简述" class="headerlink" title="文件调用简述"></a>文件调用简述</h2><p>首先是 <code>index.html</code> 文件，查看 <code>&lt;body&gt;</code> 标签部分：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- built files will be auto injected --&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br></pre></td></tr></table></figure><p>相对应的，<code>mian.js</code> 中的 Vue 实例创建部分：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">new</span> Vue(&#123;</span><br><span class="line">  el: <span class="string">'#app'</span>,</span><br><span class="line">  router,</span><br><span class="line">  components: &#123; App &#125;,</span><br><span class="line">  template: <span class="string">'&lt;App/&gt;'</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p><code>index.html</code> 中的 <code>id=&quot;app&quot;</code> 与 <code>mian.js</code> 中的 <code>el: &#39;#app&#39;</code> 的相对应，两者会在实例创建时进行替换（查看<a href="#lifecycle">生命周期图示</a>），相当于创建的实例会嵌入到 <code>index.html</code> 中。</p><p>再次看 <code>mian.js</code> 中的这段代码，其中 <code>components: { App }</code> 指定了该入口文件包含的组件，这个组件也就是整个应用的总组件 <code>App.vue</code>，其通过 <code>export</code> 进行暴露供其他组件调用。</p><p>这样，通过编辑 <code>App.vue</code> 以及该文件包含的子组件便可编辑页面显示的实际内容。</p><h2 id="Vue-文件简述"><a href="#Vue-文件简述" class="headerlink" title="Vue 文件简述"></a>Vue 文件简述</h2><p>Vue 从扩展名就可以看出，其是 Vue 项目的独有文件，并且也是 Vue 项目内容的最主要组成部分。</p><p>我们打开 <code>App.vue</code> 文件来最简单的认识一下 Vue 文件：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"./assets/logo.png"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">router-view</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript">  <span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="javascript">    name: <span class="string">'App'</span></span></span><br><span class="line"><span class="undefined">  &#125;</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="css">  <span class="selector-id">#app</span> &#123;</span></span><br><span class="line"><span class="undefined">    font-family: 'Avenir', Helvetica, Arial, sans-serif;</span></span><br><span class="line"><span class="undefined">    -webkit-font-smoothing: antialiased;</span></span><br><span class="line"><span class="undefined">    -moz-osx-font-smoothing: grayscale;</span></span><br><span class="line"><span class="undefined">    text-align: center;</span></span><br><span class="line"><span class="css">    <span class="selector-tag">color</span>: <span class="selector-id">#2c3e50</span>;</span></span><br><span class="line"><span class="undefined">    margin-top: 60px;</span></span><br><span class="line"><span class="undefined">  &#125;</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure><p>很清晰的可以看到代码分为三个部分，分别由三个标签 <code>&lt;template&gt;</code>、<code>&lt;script&gt;</code>、<code>&lt;style&gt;</code> 包裹。三个部分分别对应 HTML、Javascript 和 CSS，三种语言的代码在各自的标签内进行编写。简单地讲，可以把 Vue 文件理解为将三种语言编写在同一文档中，并赋予一些新的特性。</p><h2 id="Vue-的常用指令"><a href="#Vue-的常用指令" class="headerlink" title="Vue 的常用指令"></a>Vue 的常用指令</h2><p>最常用的指令有两个：</p><ul><li><code>v-bind</code>: 特性的绑定</li><li><code>v-on</code>： 事件的监听</li></ul><p>这两个指令都有着对应的缩写，<code>v-bind</code> 的缩写是 <code>:</code>，<code>v-on</code> 的缩写是 <code>@</code>，比如 <code>&lt;img v-bind:src=&quot;imageSrc&quot;&gt;</code> 缩写为 <code>&lt;img :src=&quot;imageSrc&quot;&gt;</code>，<code>&lt;button v-on:click=&quot;doThis&quot;&gt;&lt;/button&gt;</code> 缩写为 <code>&lt;button @click=&quot;doThis&quot;&gt;&lt;/button&gt;</code>。</p><p>除此之外，常用的指令还有：</p><ul><li><code>v-if</code> &amp; <code>v-else</code>: 条件渲染，先判断条件再决定是否渲染</li><li><code>v-show</code>: 条件渲染，先渲染后决定是否显示</li><li><code>v-for</code>: 基于数据渲染多个同类元素</li></ul><h2 id="Vue-的数据和选项"><a href="#Vue-的数据和选项" class="headerlink" title="Vue 的数据和选项"></a>Vue 的数据和选项</h2><h3 id="data"><a href="#data" class="headerlink" title="data"></a>data</h3><p>组件的数据对象，能够响应数据变化，在实例中可以定义为：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">data: &#123;</span><br><span class="line">  message: <span class="string">'Hello Vue!'</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>当组件作为模块进行编程时，<code>data</code> 的对象必须是函数：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">data: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> &#123; <span class="attr">a</span>: <span class="number">1</span> &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这是为了防止数据污染，此时 <code>return</code> 的对象则为实际调用的 <code>data</code> 对象。</p><h3 id="props"><a href="#props" class="headerlink" title="props"></a>props</h3><p>用于接收父组件传过来的数据，可以是对象或者数组，一般可以写成如下格式：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">props: &#123;</span><br><span class="line">  height: <span class="built_in">Number</span>,</span><br><span class="line">  age: &#123;</span><br><span class="line">    type: <span class="built_in">Number</span>,</span><br><span class="line">    <span class="keyword">default</span>: <span class="number">0</span>,</span><br><span class="line">    required: <span class="literal">true</span>,</span><br><span class="line">    validator: <span class="function"><span class="keyword">function</span> (<span class="params">value</span>) </span>&#123;</span><br><span class="line">      <span class="keyword">return</span> value &gt;= <span class="number">0</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>写成对象时一般会添加类型监测。</p><p>父组件向子组件进行传值则需要用 <code>v-bind</code> 进行属性的绑定：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span></span></span><br><span class="line"><span class="tag">  <span class="attr">:height</span>=<span class="string">"val"</span></span></span><br><span class="line"><span class="tag">  <span class="attr">:age</span>=<span class="string">"obj"</span></span></span><br><span class="line"><span class="tag">&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="methods"><a href="#methods" class="headerlink" title="methods"></a>methods</h3><p><code>methods</code> 是供实例调用的方法，方法中的 <code>this</code> 自动绑定为 Vue 实例，绝大部分的函数都写在 <code>methods</code> 中。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">methods: &#123;</span><br><span class="line">  plus () &#123;</span><br><span class="line">    <span class="keyword">this</span>.a++</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>子组件可以通过 <code>$emit( eventName, […args] )</code> 调用父组件的方法，父组件需要使用 <code>v-on</code> 监听子组件触发的事件：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">this</span>.$emit(<span class="string">'welcome'</span>)</span><br></pre></td></tr></table></figure><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"emit-example-simple"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">welcome-button</span> <span class="attr">v-on:welcome</span>=<span class="string">"sayHi"</span>&gt;</span><span class="tag">&lt;/<span class="name">welcome-button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="computed"><a href="#computed" class="headerlink" title="computed"></a>computed</h3><p>计算属性中的属性可以在其被调用时返回所需的属性值，相当于一个依赖于其他属性的 <code>data</code>。</p><p>以下代码相当于当有调用 <code>reversedMessage</code> 这个属性的时候，返回一个反转字符串的值：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">computed: &#123;</span><br><span class="line">  reversedMessage: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.message.split(<span class="string">''</span>).reverse().join(<span class="string">''</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>方法虽然也可以做到相同的效果，但是计算属性会进行缓存，只有在依赖属性被更新的时才触发属性内的函数。</p><p><span id="lifecycle"></span></p><h2 id="Vue-的生命周期"><a href="#Vue-的生命周期" class="headerlink" title="Vue 的生命周期"></a>Vue 的生命周期</h2><p>生命周期也是 Vue 中很重要的概念，表示 Vue 的实例从创建到销毁的过程，每个生命周期的阶段都可以执行一个钩子函数。</p><img src="/2018/10/12/VuejsEbook2/lifecycle.jpg">]]></content>
    
    <summary type="html">
    
      &lt;p&gt;自行开发的网页端电子书阅读器，本系列用于记录开发过程中的各种问题，本文为 Vue 项目的基本知识。&lt;/p&gt;
    
    </summary>
    
      <category term="文档" scheme="https://www.idkiro.xyz/categories/%E6%96%87%E6%A1%A3/"/>
    
    
      <category term="开发" scheme="https://www.idkiro.xyz/tags/%E5%BC%80%E5%8F%91/"/>
    
      <category term="阅读器" scheme="https://www.idkiro.xyz/tags/%E9%98%85%E8%AF%BB%E5%99%A8/"/>
    
      <category term="网页应用" scheme="https://www.idkiro.xyz/tags/%E7%BD%91%E9%A1%B5%E5%BA%94%E7%94%A8/"/>
    
  </entry>
  
  <entry>
    <title>Vue.js 入门学习笔记：电子书阅读器——引入</title>
    <link href="https://www.idkiro.xyz/2018/10/12/VuejsEbook1/"/>
    <id>https://www.idkiro.xyz/2018/10/12/VuejsEbook1/</id>
    <published>2018-10-12T04:52:22.000Z</published>
    <updated>2018-10-12T05:11:20.786Z</updated>
    
    <content type="html"><![CDATA[<p>自行开发的网页端电子书阅读器，本系列用于记录开发过程中的各种问题，本文为引入。</p><a id="more"></a><h1 id="Vue-js-入门学习笔记：电子书阅读器"><a href="#Vue-js-入门学习笔记：电子书阅读器" class="headerlink" title="Vue.js 入门学习笔记：电子书阅读器"></a>Vue.js 入门学习笔记：电子书阅读器</h1><p>用于记录学习 Vue.js 并开发电子书阅读器的过程。</p><p>初期参考教程：<a href="https://www.imooc.com/learn/1038" target="_blank" rel="noopener">https://www.imooc.com/learn/1038</a></p><p>Demo：<a href="http://book.idkiro.xyz/" target="_blank" rel="noopener">http://book.idkiro.xyz/</a></p><h2 id="相关框架和库的文档"><a href="#相关框架和库的文档" class="headerlink" title="相关框架和库的文档"></a>相关框架和库的文档</h2><p>Vue.js：<a href="https://cn.vuejs.org/v2/guide/index.html" target="_blank" rel="noopener">https://cn.vuejs.org/v2/guide/index.html</a></p><p>Vuex: <a href="https://vuex.vuejs.org/zh/guide/" target="_blank" rel="noopener">https://vuex.vuejs.org/zh/guide/</a></p><p>Vue Router: <a href="https://router.vuejs.org/zh/" target="_blank" rel="noopener">https://router.vuejs.org/zh/</a></p><p>Sass: <a href="https://www.sass.hk/docs/" target="_blank" rel="noopener">https://www.sass.hk/docs/</a></p><p>Element UI: <a href="http://element-cn.eleme.io/#/zh-CN/component/installation" target="_blank" rel="noopener">http://element-cn.eleme.io/#/zh-CN/component/installation</a></p><p>epub.js: <a href="https://github.com/futurepress/epub.js/blob/master/documentation/md/API.md" target="_blank" rel="noopener">https://github.com/futurepress/epub.js/blob/master/documentation/md/API.md</a></p><p>Vuescroll: <a href="http://vuescrolljs.yvescoding.org/zh/guide/" target="_blank" rel="noopener">http://vuescrolljs.yvescoding.org/zh/guide/</a></p><h2 id="引入"><a href="#引入" class="headerlink" title="引入"></a>引入</h2><p>开始学习 Vue.js 前，需要一定的HTML+JS+CSS的基础，理解三个语言的基本概念和语法结构便可。</p><p>除此之外需要知道 shell（无论是 cmd、bash 还是 zsh）的一些基本的指令。</p><p>电子书阅读器使用 webpack 模板进行开发，需要预先安装 node.js、Vue-cli。</p><h3 id="安装必要框架和库"><a href="#安装必要框架和库" class="headerlink" title="安装必要框架和库"></a>安装必要框架和库</h3><h4 id="node-js"><a href="#node-js" class="headerlink" title="node.js"></a>node.js</h4><p>下载地址: <a href="https://nodejs.org/en/download/" target="_blank" rel="noopener">https://nodejs.org/en/download/</a></p><p>安装前选择正确的版本，安装时注意将path添加到环境变量，具体安装方法可参考：<a href="https://www.runoob.com/nodejs/nodejs-install-setup.html" target="_blank" rel="noopener">https://www.runoob.com/nodejs/nodejs-install-setup.html</a></p><p>安装完毕后可以在shell中输入 <code>node --version</code> 和 <code>npm --version</code> 查看node.js是否安装成功。</p><h4 id="Vue-cli"><a href="#Vue-cli" class="headerlink" title="Vue-cli"></a>Vue-cli</h4><p>直接在shell中输入指令：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install vue-cli -g</span><br></pre></td></tr></table></figure><p><code>-g</code> 表示全局安装，之后就可以使用Vue-cli方便地搭建单页面应用。</p><p>如果npm的下载速度过慢，可以使用淘宝的cnpm：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install -g cnpm --registry=https://registry.npm.taobao.org</span><br></pre></td></tr></table></figure><p>之后就可以使用cnpm代替npm进行模块的安装了。</p><p>除了npm，也可以使用yarn进行替代：<a href="https://yarn.bootcss.com/docs/" target="_blank" rel="noopener">https://yarn.bootcss.com/docs/</a></p><h3 id="使用vue-cli和webpack模板搭建应用"><a href="#使用vue-cli和webpack模板搭建应用" class="headerlink" title="使用vue-cli和webpack模板搭建应用"></a>使用vue-cli和webpack模板搭建应用</h3><p>WebStorm 可以比较轻松地搭建模板应用，并且学生可以获得 WebStorm 的免费教育授权。</p><p>WebStorm 下载地址：<a href="http://www.jetbrains.com/webstorm/download/" target="_blank" rel="noopener">http://www.jetbrains.com/webstorm/download/</a></p><p>汉化包：<a href="https://github.com/pingfangx/TranslatorX" target="_blank" rel="noopener">https://github.com/pingfangx/TranslatorX</a></p><p>如果使用 vscode 等文本编辑器，可以使用命令搭建：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vue init webpack my-project-name</span><br></pre></td></tr></table></figure><p><code>my-project-name</code> 对应文件夹的名字，现在的版本不推荐使用驼峰命名。</p><p>输入命令后会进入搭建应用的引导，第一次使用可以先全部回车应用默认的设置，也可以按照提示选择或输入。</p><p>一个例子：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">? Project name ebookreader</span><br><span class="line">? Project description A  ebookreader with Vue.js</span><br><span class="line">? Author IDKiro</span><br><span class="line">? Vue build standalone</span><br><span class="line">? Install vue-router? Yes</span><br><span class="line">? Use ESLint to lint your code? Yes</span><br><span class="line">? Pick an ESLint preset Standard</span><br><span class="line">? Set up unit tests No</span><br><span class="line">? Setup e2e tests with Nightwatch? No</span><br><span class="line">? Should we run `npm install` for you after the project has been created? (recommended) npm</span><br></pre></td></tr></table></figure><p>完成以后可以在 my-project-name 中看到以下文件：</p><img src="/2018/10/12/VuejsEbook1/1.png"><p>此时可以进入 my-project-name 目录下</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> my-project-name</span><br></pre></td></tr></table></figure><p>然后输入以下命令运行开发实例</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm run dev</span><br></pre></td></tr></table></figure><p>在浏览器中访问 <code>localhost:8080</code> 即可看到：</p><img src="/2018/10/12/VuejsEbook1/2.png"><p>这时应用已经搭建完毕，可以开始写程序了。</p><h3 id="Demo的使用"><a href="#Demo的使用" class="headerlink" title="Demo的使用"></a>Demo的使用</h3><p>如果想查看按此笔记编写电子书阅读器的效果，可以将项目clone到本地。</p><p>进入项目目录下运行命令：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 首次运行安装依赖</span></span><br><span class="line">npm install</span><br><span class="line"></span><br><span class="line"><span class="comment"># 运行开发实例，访问localhost:8080</span></span><br><span class="line">npm run dev</span><br></pre></td></tr></table></figure><p>在浏览器中访问 <code>localhost:8080</code> 即可使用本电子书阅读器。</p><h3 id="部署Demo到服务器"><a href="#部署Demo到服务器" class="headerlink" title="部署Demo到服务器"></a>部署Demo到服务器</h3><p>首先要构建部署的项目文件，通过指令：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm run build</span><br></pre></td></tr></table></figure><p>在项目根目录下会生成 <code>dist</code> 文件夹，文件夹中的文件直接部署到服务器即可。</p><h2 id="安装本项目中使用的框架和库"><a href="#安装本项目中使用的框架和库" class="headerlink" title="安装本项目中使用的框架和库"></a>安装本项目中使用的框架和库</h2><p>文档介绍中提到过的均为本项目所使用到的依赖，如果一个一个安装依赖包稍微有些繁琐，并且可能存在版本上的问题，所以文件夹中的 <code>package.json</code> 就起到了很大的作用，该文件包含了项目所需要的包并且指定了的版本。将本项目的 <code>package.json</code> 对刚创建的项目的 <code>package.json</code> 进行覆盖，然后在 shell 中输入指令即可完成依赖的安装：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install</span><br></pre></td></tr></table></figure><h3 id="其他依赖包的安装"><a href="#其他依赖包的安装" class="headerlink" title="其他依赖包的安装"></a>其他依赖包的安装</h3><p>安装依赖包使用：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install package-name --save</span><br></pre></td></tr></table></figure><p>仅开发依赖使用：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install package-name --save-dev</span><br></pre></td></tr></table></figure><p><strong>两个例子：</strong></p><p>Vuex的安装：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install vuex --save</span><br></pre></td></tr></table></figure><p>Sass的安装：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install node-sass --save-dev</span><br></pre></td></tr></table></figure><h2 id="编写项目前的准备"><a href="#编写项目前的准备" class="headerlink" title="编写项目前的准备"></a>编写项目前的准备</h2><h3 id="开启同局域网下其他设备的访问"><a href="#开启同局域网下其他设备的访问" class="headerlink" title="开启同局域网下其他设备的访问"></a>开启同局域网下其他设备的访问</h3><p>打开 <code>config</code> 文件夹下的 <code>index.js</code> 文件，查看第16~17行：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">host: <span class="string">'localhost'</span>,</span><br><span class="line">port: <span class="number">8080</span>,</span><br></pre></td></tr></table></figure><p>将 <code>host</code> 修改为 <code>&#39;0.0.0.0&#39;</code> 可以开启监听所有ip的请求，方便其他设备（比如手机）查看页面，修改 <code>port</code> 可以修改网页访问的端口，开发中一般不做修改。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">host: <span class="string">'0.0.0.0'</span>,</span><br><span class="line">port: <span class="number">8080</span>,</span><br></pre></td></tr></table></figure><p>使用其他设备访问该网页还需要知道本机（运行该网页的PC）的ip，windows的指令为 <code>ipconfig</code>，linux 的指令为 <code>ifconfig -a</code>。</p><p>知道本机ip后可以使用 <code>ip:8080</code> 进行网页的访问</p><h3 id="生成应用所需要的图标"><a href="#生成应用所需要的图标" class="headerlink" title="生成应用所需要的图标"></a>生成应用所需要的图标</h3><p>首先找到应用所需要的图标，在 Iconfont 下载 svg 矢量图格式的图标：</p><p>Iconfont: <a href="http://www.iconfont.cn/" target="_blank" rel="noopener">http://www.iconfont.cn/</a></p><p>使用下载的图标在 IcoMoon 生成图标组件：</p><p>IcoMoon: <a href="https://icomoon.io/app/" target="_blank" rel="noopener">https://icomoon.io/app/</a></p><p>生成图标组件后下载组件压缩包，如果需要在多台终端上开发，最好将压缩包文件放在云端，因为 IcoMoon 的免费版没有云端保存功能，但是可以导入项目。</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;自行开发的网页端电子书阅读器，本系列用于记录开发过程中的各种问题，本文为引入。&lt;/p&gt;
    
    </summary>
    
      <category term="文档" scheme="https://www.idkiro.xyz/categories/%E6%96%87%E6%A1%A3/"/>
    
    
      <category term="开发" scheme="https://www.idkiro.xyz/tags/%E5%BC%80%E5%8F%91/"/>
    
      <category term="阅读器" scheme="https://www.idkiro.xyz/tags/%E9%98%85%E8%AF%BB%E5%99%A8/"/>
    
      <category term="网页应用" scheme="https://www.idkiro.xyz/tags/%E7%BD%91%E9%A1%B5%E5%BA%94%E7%94%A8/"/>
    
  </entry>
  
  <entry>
    <title>异度神剑2战斗后对话查询工具</title>
    <link href="https://www.idkiro.xyz/2018/08/07/xb2voice/"/>
    <id>https://www.idkiro.xyz/2018/08/07/xb2voice/</id>
    <published>2018-08-07T09:23:14.000Z</published>
    <updated>2018-08-08T06:32:44.000Z</updated>
    
    <content type="html"><![CDATA[<p>受人委托写的一个用于筛选并播放异度神剑2各人物战斗后的对话的工具</p><a id="more"></a><h2 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h2><p>根据选择的人物筛选并播放相关角色的战斗后语音</p><img src="/2018/08/07/xb2voice/step1.png"><h2 id="Feature"><a href="#Feature" class="headerlink" title="Feature"></a>Feature</h2><ol><li>切换中文/日文</li><li>悬停在选项上可直接显示另一语言的文本</li><li>点击角色头像选择最多三个角色</li><li>筛选选择角色的相关对话组</li><li>播放对话组内的所有对话并显示相应的文本</li><li>双击文本可以播放该文本的语音</li><li>支持常见的播放器操作</li></ol><h2 id="Instruction"><a href="#Instruction" class="headerlink" title="Instruction"></a>Instruction</h2><h4 id="如何筛选对话组："><a href="#如何筛选对话组：" class="headerlink" title="如何筛选对话组："></a>如何筛选对话组：</h4><ol><li>程序运行后会自动加载所有可选角色的头像和名字，点击角色头像便可以进行筛选</li><li>筛选后和该角色无相关对话的角色会消失，对话组列表则会同时筛选只与当前选择角色有关的对话组</li><li>对话组最多有三个角色参与，筛选也最多可选择三个角色，筛选选中的角色会根据选择顺序显示在对话组列表上方</li><li>点击重置选择按钮可以清楚所有角色的选择，恢复筛选前的状态</li></ol><h4 id="播放相关的操作："><a href="#播放相关的操作：" class="headerlink" title="播放相关的操作："></a>播放相关的操作：</h4><ol><li>选择对话组以后默认按对话组内语音顺序播放语音</li><li>点击循环模式切换按钮切换至列表循环和单语音循环</li><li>可以单击上一首、播放\暂停、下一首按钮进行常用的播放器操作，播放进度条支持拖动，音量支持拖动调整和静音</li></ol><h4 id="语言相关："><a href="#语言相关：" class="headerlink" title="语言相关："></a>语言相关：</h4><ol><li>在语言选择栏中可以选择中文\日文，选择以后界面上的文字会自动切换语言</li><li>悬停在角色、对话组、语音文本上时可以显示另一种语言的文本</li></ol><h4 id="其他："><a href="#其他：" class="headerlink" title="其他："></a>其他：</h4><ol><li>悬停在标题上可以查看本程序的staff</li></ol><h2 id="Development-tools"><a href="#Development-tools" class="headerlink" title="Development tools:"></a>Development tools:</h2><p>Qt 5.9.3</p><p>Visual Studio 2017</p><h2 id="Developer"><a href="#Developer" class="headerlink" title="Developer"></a>Developer</h2><h4 id="数据挖掘"><a href="#数据挖掘" class="headerlink" title="数据挖掘:"></a>数据挖掘:</h4><p>@Moosehunter(Xenoblade Subreddit Discord)</p><h4 id="对话听写与翻译"><a href="#对话听写与翻译" class="headerlink" title="对话听写与翻译:"></a>对话听写与翻译:</h4><p>@vinsanityvc(NGA)</p><p>@takamana(stage1st)</p><h4 id="游戏内对话确认协助"><a href="#游戏内对话确认协助" class="headerlink" title="游戏内对话确认协助:"></a>游戏内对话确认协助:</h4><p>@天天の幻想(Baidu Tieba: 异度之刃)</p><p>@nanami_c(Baidu Tieba: 异度之刃)</p><p>@黑礼帽的誓言(Baidu Tieba: 异度之刃)</p><h4 id="主程序"><a href="#主程序" class="headerlink" title="主程序:"></a>主程序:</h4><p>@IDKiro(NS in ZJU QQ Group)</p><h4 id="特别感谢"><a href="#特别感谢" class="headerlink" title="特别感谢:"></a>特别感谢:</h4><p>@TheKjozk(YouTube)</p><p>Monolith Soft &amp; Nintendo</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;受人委托写的一个用于筛选并播放异度神剑2各人物战斗后的对话的工具&lt;/p&gt;
    
    </summary>
    
      <category term="文档" scheme="https://www.idkiro.xyz/categories/%E6%96%87%E6%A1%A3/"/>
    
    
      <category term="主机游戏" scheme="https://www.idkiro.xyz/tags/%E4%B8%BB%E6%9C%BA%E6%B8%B8%E6%88%8F/"/>
    
      <category term="工具" scheme="https://www.idkiro.xyz/tags/%E5%B7%A5%E5%85%B7/"/>
    
      <category term="异度之刃2" scheme="https://www.idkiro.xyz/tags/%E5%BC%82%E5%BA%A6%E4%B9%8B%E5%88%832/"/>
    
  </entry>
  
  <entry>
    <title>shadowsocks-manager一键安装脚本</title>
    <link href="https://www.idkiro.xyz/2018/03/28/ssmgrInstall/"/>
    <id>https://www.idkiro.xyz/2018/03/28/ssmgrInstall/</id>
    <published>2018-03-28T08:49:26.000Z</published>
    <updated>2018-08-16T07:59:13.000Z</updated>
    
    <content type="html"><![CDATA[<p>个人写的shadowsocks-manager一键安装脚本，可以在CentOS上一键部署shadowsocks-manager管理面板和节点</p><a id="more"></a><h1 id="shadowsocks-manager-一键安装脚本"><a href="#shadowsocks-manager-一键安装脚本" class="headerlink" title="shadowsocks-manager 一键安装脚本"></a>shadowsocks-manager 一键安装脚本</h1><p>系统要求：CentOS</p><p>内存要求：管理面板≥1G，节点≥256M</p><p>依赖：wget</p><h3 id="特性："><a href="#特性：" class="headerlink" title="特性："></a>特性：</h3><ol><li>管理面板安装完整版，节点安装tiny版，降低节点的安装内存要求</li><li>安装时可自定义加密方式、密码、端口、邮箱</li><li>自动配置开机自启</li><li>x64可选择安装和启用魔改版BBR</li></ol><h3 id="安装方法："><a href="#安装方法：" class="headerlink" title="安装方法："></a>安装方法：</h3><p>复制下面的指令粘贴到vps终端中，按照提示进行操作</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">wget --no-check-certificate https://raw.githubusercontent.com/IDKiro/ssmgr-install/master/ssmgr-install.sh</span><br><span class="line">chmod +x ssmgr-install.sh</span><br><span class="line">./ssmgr-install.sh</span><br></pre></td></tr></table></figure><p>如选择安装和启用魔改BBR，需要重启后再次运行脚本: <code>./ssmgr-install.sh</code>，并按照提示选择正确的选项</p><h3 id="其他设置："><a href="#其他设置：" class="headerlink" title="其他设置："></a>其他设置：</h3><p>支付宝、图标等参照官方wiki配置</p><p><a href="https://github.com/shadowsocks/shadowsocks-manager/wiki" target="_blank" rel="noopener">https://github.com/shadowsocks/shadowsocks-manager/wiki</a></p><h3 id="TODO"><a href="#TODO" class="headerlink" title="TODO:"></a>TODO:</h3><ol><li>安装时配置支付功能</li><li>其他系统支持</li></ol>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;个人写的shadowsocks-manager一键安装脚本，可以在CentOS上一键部署shadowsocks-manager管理面板和节点&lt;/p&gt;
    
    </summary>
    
      <category term="文档" scheme="https://www.idkiro.xyz/categories/%E6%96%87%E6%A1%A3/"/>
    
    
      <category term="SS" scheme="https://www.idkiro.xyz/tags/SS/"/>
    
      <category term="脚本" scheme="https://www.idkiro.xyz/tags/%E8%84%9A%E6%9C%AC/"/>
    
      <category term="ssmgr" scheme="https://www.idkiro.xyz/tags/ssmgr/"/>
    
  </entry>
  
  <entry>
    <title>校园网联机攻略（网易UU加速器）</title>
    <link href="https://www.idkiro.xyz/2018/03/12/NetworkInZJU-UU/"/>
    <id>https://www.idkiro.xyz/2018/03/12/NetworkInZJU-UU/</id>
    <published>2018-03-12T08:43:25.000Z</published>
    <updated>2018-08-07T09:24:53.000Z</updated>
    
    <content type="html"><![CDATA[<p>浙江大学主机游戏联机教程第四部分，主要讲解网易UU加速器在校园网环境下的联机方案。</p><a id="more"></a><h1 id="说明"><a href="#说明" class="headerlink" title="说明"></a>说明</h1><p>本教程基于网易UU加速器，出现的所有问题与本人无关，请自行联系网易UU客服。</p><p>个人感觉UU为了实现加速网络和物理网络的隔离（为了不让你的PC可以通过加速器翻墙），修改了一些敏感的PC网络设置，根据反馈，有可能导致开启加速器以后无法上网。</p><p>该教程撰写于2018年3月24日，不保证文章时效性。</p><p>感谢WKJ提供简易教程方便本人进行教程的编写。</p><h1 id="教程"><a href="#教程" class="headerlink" title="教程"></a>教程</h1><h2 id="智能路由器-网易UU加速器"><a href="#智能路由器-网易UU加速器" class="headerlink" title="智能路由器+网易UU加速器"></a>智能路由器+网易UU加速器</h2><p><em>在本教程中，智能加速器不是必须的，但是一个支持L2TP协议的路由器是必须的，但是选择和教程中差别较大的路由器就只能自行研究使用方法了，只要能连上校园网就行。</em><br><em>如果你已经有一个智能路由器了，比如固件可以刷成老毛子(padavan)固件或者梅林固件的路由器（当然有很多功能类似的固件）。除了阅读这份教程以外，你可以逛恩山无线论坛，里面有各种路由器型号的固件下载、刷固件教程以及设置教程，有问题也可以在群中@我。</em><br><em>比较常见并且便宜的支持padavan固件的路由器：小米路由、极路由、斐讯等等。</em><br><em>有钱一点的可以买个华硕的路由器，可以刷梅林固件，当然土豪可以买网件的路由器。</em><br><em>另外极路由有一个15天解锁刷机的期限，如果急着用推荐买二手</em></p><h3 id="1-给路由器安装padavan固件"><a href="#1-给路由器安装padavan固件" class="headerlink" title="1.给路由器安装padavan固件"></a>1.给路由器安装padavan固件</h3><p><em>本教程以<strong>斐讯k2</strong>安装padavan为例</em></p><p><strong>斐讯k2可下载群文件中的<img src="/2018/03/12/NetworkInZJU-UU/1.png">，里面是一键刷机的整合包，内附简单操作步骤，成功后你可以跳过该部分。</strong></p><p>①首先你要知道你路由器的型号<br>比如极路由-极1s对应的型号一般是HC5661A，斐讯k2的对应的一般是PSG1218，这个型号可以在机身的贴纸上找到。</p><p>②下载路由所需要的padavan固件<br>打开下面的云盘中的一个。</p><p><a href="https://eyun.baidu.com/s/3pLMbUqR" target="_blank" rel="noopener">https://eyun.baidu.com/s/3pLMbUqR</a><br><a href="http://opt.cn2qq.com/padavan/" target="_blank" rel="noopener">http://opt.cn2qq.com/padavan/</a></p><p>进入最新的文件夹，下面会有很多的固件文件<br><img src="/2018/03/12/NetworkInZJU-UU/2-300x176.png"><br>这时候按下Ctrl+F，也就是搜索页面上的信息，输入你的路由器型号<br><img src="/2018/03/12/NetworkInZJU-UU/3.png"><br>就找到了你路由器的固件，斐讯k2有两个版本，你需要知道你的路由器的内存是256M还是64M的，然后下载正确的固件。斐讯k2默认是64M，如果你不清楚，那就选择64M的版本即可。</p><p>③给你的路由器刷入padavan固件<br>下面是斐讯k2的刷固件教程，其他型号请在恩山无线论坛中搜索相关教程。<br><a href="http://www.right.com.cn/forum/thread-209423-1-1.html" target="_blank" rel="noopener">http://www.right.com.cn/forum/thread-209423-1-1.html</a></p><h3 id="2-配置路由器的准备工作"><a href="#2-配置路由器的准备工作" class="headerlink" title="2.配置路由器的准备工作"></a>2.配置路由器的准备工作</h3><p><em>使用路由器需要用到学校的有线网络，相关教程cc98上有比较详细的，下面这个cc98的教程是让电脑直接连接有线的，我推荐没有用过有线的同学照着做一次来理解和测试。</em></p><p><a href="http://www.cc98.org/dispbbs.asp?boardID=226&amp;ID=2928932#4" target="_blank" rel="noopener">http://www.cc98.org/dispbbs.asp?boardID=226&amp;ID=2928932#4</a></p><p>以下是准备工作的简单教程：<br>对于紫金港校区，你只需要把网线插到路由器上就行，然后直接跳到路由器的设置。<br>对于玉泉校区和西溪校区（华家池和之江不了解），因为是静态IP所以需要申请有线网络IP，可以直接在微信的学生公寓公众号内实现，申请需要你的MAC地址，查看方法：在电脑上按win+r呼出运行界面，输入cmd，回车运行命令提示符，输入ipconfig/all后回车，找到你的MAC地址并记录（只要是个MAC地址就行，无论有线无线）<br><img src="/2018/03/12/NetworkInZJU-UU/4.png"><br>申请后得到以下的信息并记录<br><img src="/2018/03/12/NetworkInZJU-UU/5-300x271.png"><br>当然你需要用网线连接上你的路由器</p><h3 id="3-配置路由器上网"><a href="#3-配置路由器上网" class="headerlink" title="3.配置路由器上网"></a>3.配置路由器上网</h3><p>①进入padavan的控制台<br>一般在浏览器输入192.168.123.1即可，用户名密码都是admin</p><p>②设置L2TP来连接校园网<br>选择外部网络选项<br><img src="/2018/03/12/NetworkInZJU-UU/6.png"><br>协议选择L2TP，加速可以都打开<br><img src="/2018/03/12/NetworkInZJU-UU/7.png"><br>MAN IP设置填入之前记录的申请到的ip地址等信息，MTU你可以设置1428，有玄学加成（紫金港使用自动获取）<br><img src="/2018/03/12/NetworkInZJU-UU/8.png"><br>DNS设置<br><img src="/2018/03/12/NetworkInZJU-UU/tutorial_edit1.png"><br>VPN客户端设置，用户名和密码填写自己VPN的用户名和密码<br><img src="/2018/03/12/NetworkInZJU-UU/tutorial_edit2.png"><br>填写记录的MAC地址（物理地址、网卡地址）<br><img src="/2018/03/12/NetworkInZJU-UU/11.png"><br><strong>保存设置，重启路由器以后看看能不能上网，可以的话就证明已经连接到了校园网</strong></p><h3 id="4-使用网易UU加速器给NS加速"><a href="#4-使用网易UU加速器给NS加速" class="headerlink" title="4.使用网易UU加速器给NS加速"></a>4.使用网易UU加速器给NS加速</h3><p>开始这部分前，请保证以下条件：</p><ol><li>PC和Switch都连接在路由器上</li><li>PC和Switch都可以正常连接上互联网</li><li>网易UU加速器已经安装完毕并注册登录</li></ol><p>为了有更好的稳定性，我推荐：</p><ol><li>PC和Switch都通过有线的方式连接路由器</li><li>关闭路由器和PC上的其他代理，特别是涉及UDP转发的代理</li></ol><p><strong>继续教程</strong></p><p>现在打开PC上的网易UU加速器，选择全部游戏-&gt;主机游戏-&gt;Switch，点击NS的图标将其添加到我的加速中<br><img src="/2018/03/12/NetworkInZJU-UU/ct4-1.png"><br>点击一键加速，加速成功后弹出设置引导<br><img src="/2018/03/12/NetworkInZJU-UU/ct4-2.png"><br><strong>不要关掉这个页面</strong>，接下来</p><h3 id="5-Switch的设置"><a href="#5-Switch的设置" class="headerlink" title="5.Switch的设置"></a>5.Switch的设置</h3><p>进入网络设置页面：System Settings – Internet – Internet Settings，并点击选取你连上的网络，点击改变设置Change Settings<br><img src="/2018/03/12/NetworkInZJU-UU/ct4-3.png"><br>从上到下将IP地址、子网掩码、网关和DNS改为上面UU加速器提供的配置，如下所示<br><img src="/2018/03/12/NetworkInZJU-UU/ct4-4.png"><br>完成设置后，返回到网络测试，如下所示表示连接成功<br><img src="/2018/03/12/NetworkInZJU-UU/ct4-5.png"></p><h2 id="PC热点共享-手机版网易UU加速器"><a href="#PC热点共享-手机版网易UU加速器" class="headerlink" title="PC热点共享+手机版网易UU加速器"></a>PC热点共享+手机版网易UU加速器</h2><h3 id="1-配置wifi共享"><a href="#1-配置wifi共享" class="headerlink" title="1.配置wifi共享"></a>1.配置wifi共享</h3><p>首先当然你需要会开启WIFI热点分享网络，虽然win10自带有热点分享的功能，但是那个有一些问题，所以推荐各位需要看本教程的玩家下一个一键开启热点的软件，比如猎豹wifi和360wifi。<br>这里用大数字举例，下载360wifi以后安装并启动，双击悬浮窗弹出设置界面，将ID和密码进行修改（推荐输入英文），保存以后开启WIFI。<br><img src="/2018/03/12/NetworkInZJU-UU/ct4-6.png"><br>用手机连接该wifi，测试下开启的热点看是否为2.4G的WIFI，如果你的手机（或者其他设备）可以连接热点进行上网了，那就已经成功配置好wifi共享了。</p><h3 id="2-使用手机版网易UU加速器"><a href="#2-使用手机版网易UU加速器" class="headerlink" title="2.使用手机版网易UU加速器"></a>2.使用手机版网易UU加速器</h3><p>开始这部分前，请保证以下条件：</p><ol><li>手机和Switch都连接在PC创建的热点上</li><li>手机和Switch都可以正常连接上互联网</li></ol><p>使用你的手机到官网下载网易UU加速器的手机版并安装，启动后点击界面右上角的感叹号，弹出设置页面<br><img src="/2018/03/12/NetworkInZJU-UU/ct4-7.png"><br>回到主界面可以看到NS加速已添加，点击<strong>一键加速</strong>按钮<br><img src="/2018/03/12/NetworkInZJU-UU/ct4-8.png"><br>你的手机也许会弹出添加VPN连接的请求，点击确定即可<br><img src="/2018/03/12/NetworkInZJU-UU/ct4-9.png"><br>弹出的页面的信息很重要，请记录中间一串数字，这串数据冒号前server的ip，冒号后为端口<br><img src="/2018/03/12/NetworkInZJU-UU/ct4-10.png"></p><h3 id="3-Switch的设置"><a href="#3-Switch的设置" class="headerlink" title="3.Switch的设置"></a>3.Switch的设置</h3><p>进入网络设置页面：System Settings – Internet – Internet Settings，并点击选取你连上的网络，点击改变设置Change Settings<br><img src="/2018/03/12/NetworkInZJU-UU/ct4-3.png"><br>从上到下将网络代理设置为加速成功后提示框显示的 IP 和端口，如下所示<br><img src="/2018/03/12/NetworkInZJU-UU/ct4-11.png"><br>完成设置后，返回到网络测试，如下所示表示连接成功<br><img src="/2018/03/12/NetworkInZJU-UU/ct4-5.png"></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;浙江大学主机游戏联机教程第四部分，主要讲解网易UU加速器在校园网环境下的联机方案。&lt;/p&gt;
    
    </summary>
    
      <category term="教程" scheme="https://www.idkiro.xyz/categories/%E6%95%99%E7%A8%8B/"/>
    
    
      <category term="联机" scheme="https://www.idkiro.xyz/tags/%E8%81%94%E6%9C%BA/"/>
    
      <category term="主机游戏" scheme="https://www.idkiro.xyz/tags/%E4%B8%BB%E6%9C%BA%E6%B8%B8%E6%88%8F/"/>
    
      <category term="网易UU加速器" scheme="https://www.idkiro.xyz/tags/%E7%BD%91%E6%98%93UU%E5%8A%A0%E9%80%9F%E5%99%A8/"/>
    
  </entry>
  
  <entry>
    <title>校园网联机攻略（其他方法）</title>
    <link href="https://www.idkiro.xyz/2017/12/08/NetworkInZJU-Other/"/>
    <id>https://www.idkiro.xyz/2017/12/08/NetworkInZJU-Other/</id>
    <published>2017-12-08T08:30:01.000Z</published>
    <updated>2018-08-07T09:24:50.000Z</updated>
    
    <content type="html"><![CDATA[<p>浙江大学主机游戏联机教程第三部分，主要讲解除了代理以外的联机方式，比如ChinaNet和流量卡</p><a id="more"></a><h1 id="说明"><a href="#说明" class="headerlink" title="说明"></a>说明</h1><p>服务器停用，相关说明已删除。<br>该教程撰写于2017年11月20日，不保证文章正确性。</p><p>这部分教程是对联机方法的补充，不涉及到任何我提供的网络服务，我也不会对这些方法的详细使用作解答。</p><h1 id="教程"><a href="#教程" class="headerlink" title="教程"></a>教程</h1><h2 id="手机热点"><a href="#手机热点" class="headerlink" title="手机热点"></a>手机热点</h2><p>这个方法很简单，你只需要两个东西：</p><ol><li>支持电信4G并且可以开热点的手机或者随身WIFI</li><li>电信流量卡，比如小米日租卡、腾讯大王卡</li></ol><p>但是需要注意的是，并不是所有校区的电信信号都是很好的，比如玉泉个别宿舍用电信4G热点分享并不联机，所以最好先借一台支持电信的手机来试试。</p><h2 id="直连ChinaNet"><a href="#直连ChinaNet" class="headerlink" title="直连ChinaNet"></a>直连ChinaNet</h2><p>这应该是校内联机最省钱但最不省心的方法了。</p><p>你需要做的也只有两步：</p><ol><li>去淘宝购买ChinaNet的账号</li><li>NS直连ChinaNet的WIFI，在弹出来的网页中进行登录<img src="/2017/12/08/NetworkInZJU-Other/22.png"></li></ol><p>但是你需要注意两点：</p><ol><li>NS的无线网卡非常屎，如果你寝室的ChinaNet信号并不是特别好，那你可能就要频繁断开了</li><li>你每次使用ChinaNet都需要登录，但你可以买包月的账号减少频繁购买ChinaNet的麻烦</li></ol><p>ChinaNet的网络基本不会和其他网络之间有墙，玩乌贼的同学基本上ChinaNet是必备的。</p><h2 id="智能路由器-ChinaNet"><a href="#智能路由器-ChinaNet" class="headerlink" title="智能路由器+ChinaNet"></a>智能路由器+ChinaNet</h2><p>对于不需要翻墙的同学，使用Chinanet更加简单，但是NS登录ChinaNet较为麻烦并且因为NS的无线网卡机能过低ChinaNet的信号往往堪忧，所以使用体验较差，所以这里使用桥接的方法解决这些问题。</p><h3 id="1-给路由器安装padavan固件"><a href="#1-给路由器安装padavan固件" class="headerlink" title="1.给路由器安装padavan固件"></a>1.给路由器安装padavan固件</h3><p><em>本教程以<strong>斐讯k2</strong>安装padavan为例</em></p><p><strong>斐讯k2可下载群文件中的<img src="/2017/12/08/NetworkInZJU-Other/1.png">，里面是一键刷机的整合包，内附简单操作步骤，成功后你可以跳过该部分。</strong></p><p>①首先你要知道你路由器的型号<br>比如极路由-极1s对应的型号一般是HC5661A，斐讯k2的对应的一般是PSG1218，这个型号可以在机身的贴纸上找到。</p><p>②下载路由所需要的padavan固件<br>打开下面的云盘。</p><p><a href="https://eyun.baidu.com/s/3kV0JV19" target="_blank" rel="noopener">https://eyun.baidu.com/s/3kV0JV19</a></p><p>进入最新的文件夹，下面会有很多的固件文件<br><img src="/2017/12/08/NetworkInZJU-Other/2-300x176.png"><br>这时候按下Ctrl+F，也就是搜索页面上的信息，输入你的路由器型号<br><img src="/2017/12/08/NetworkInZJU-Other/3.png"><br>就找到了你路由器的固件，斐讯k2有两个版本，你需要知道你的路由器的内存是256M还是64M的，然后下载正确的固件。斐讯k2默认是64M，如果你不清楚，那就选择64M的版本即可。</p><p>③给你的路由器刷入padavan固件<br>下面是斐讯k2的刷固件教程，其他型号请在恩山无线论坛中搜索相关教程。<br><a href="http://www.right.com.cn/forum/thread-209423-1-1.html" target="_blank" rel="noopener">http://www.right.com.cn/forum/thread-209423-1-1.html</a></p><h3 id="2-配置路由器"><a href="#2-配置路由器" class="headerlink" title="2.配置路由器"></a>2.配置路由器</h3><p>①进入padavan的控制台<br>一般在浏览器输入192.168.123.1即可，用户名密码都是admin。<br>②进入高级设置中的无线2.4GHz，选择无线桥接选项卡<br><img src="/2017/12/08/NetworkInZJU-Other/15.png"><br><img src="/2017/12/08/NetworkInZJU-Other/16.png"><br>③进行中继设置<br>其中上级SSID请点击向下的箭头进行选择，选择信号最强的ChinaNet信号（越接近100%越好），如果没有可更换其他信道。<br><img src="/2017/12/08/NetworkInZJU-Other/17.png"><br><img src="/2017/12/08/NetworkInZJU-Other/18.png"><br>④进入wan口连接设置，选择外网设置选项卡<br><img src="/2017/12/08/NetworkInZJU-Other/19.png"><br><img src="/2017/12/08/NetworkInZJU-Other/20.png"><br>⑤设置wan口连接<br><img src="/2017/12/08/NetworkInZJU-Other/21.png"><br>⑥使用手机或者电脑快速登录ChinaNet<br>浏览器内输入<a href="portal.wifi.189.cn">portal.wifi.189.cn</a>进行登录，因为手机和电脑浏览器有cookie存储账号密码，以后登录会快捷很多。<br><img src="/2017/12/08/NetworkInZJU-Other/22.png"></p><h3 id="3-NS连接路由器"><a href="#3-NS连接路由器" class="headerlink" title="3.NS连接路由器"></a>3.NS连接路由器</h3><p>此时路由器已经登录了ChinaNet，连接上路由器的WIFI后相当于NS也连接上了ChinaNet的网络。</p><h2 id="智能路由器-加速器"><a href="#智能路由器-加速器" class="headerlink" title="智能路由器+加速器"></a>智能路由器+加速器</h2><p>有一些加速器在有一些智能路由器上有插件，只要购买了加速器并在加速器上设置了插件就可以很方便地让NS联机了。</p><h3 id="1-准备工作"><a href="#1-准备工作" class="headerlink" title="1.准备工作"></a>1.准备工作</h3><p>你可以在路由器的插件选择页面中查看支持插件的路由器，然后按照自己的需求进行购买。小白请自行询问客服，不要来问我。</p><h3 id="2-配置路由器的准备工作"><a href="#2-配置路由器的准备工作" class="headerlink" title="2.配置路由器的准备工作"></a>2.配置路由器的准备工作</h3><p><em>使用路由器需要用到学校的有线网络，相关教程cc98上有比较详细的，下面这个cc98的教程是让电脑直接连接有线的，我推荐没有用过有线的同学照着做一次来理解和测试。</em></p><p><a href="http://www.cc98.org/dispbbs.asp?boardID=226&amp;ID=2928932#4" target="_blank" rel="noopener">http://www.cc98.org/dispbbs.asp?boardID=226&amp;ID=2928932#4</a></p><p>以下是准备工作的简单教程：<br>对于紫金港校区，你只需要把网线插到路由器上就行，然后直接跳到路由器的设置。<br>对于玉泉校区和西溪校区（华家池和之江不了解），因为是静态IP所以需要申请有线网络IP，可以直接在微信的学生公寓公众号内实现，申请需要你的MAC地址，查看方法：在电脑上按win+r呼出运行界面，输入cmd，回车运行命令提示符，输入ipconfig/all后回车，找到你的MAC地址并记录（只要是个MAC地址就行，无论有线无线）<br><img src="/2017/12/08/NetworkInZJU-Other/4.png"><br>申请后得到以下的信息并记录<br><img src="/2017/12/08/NetworkInZJU-Other/5-300x271.png"><br>当然你需要用网线连接上你的路由器</p><h3 id="3-配置路由器上网"><a href="#3-配置路由器上网" class="headerlink" title="3.配置路由器上网"></a>3.配置路由器上网</h3><p>①进入路由器控制台<br>这个你看买来路由器的说明书上就有写的。</p><p>②设置L2TP来连接校园网<br>1.如果是玉泉、西溪则需要选择手动方式（图为极路由的设置界面），其他路由器请自行研究。IP地址、DNS等设置填入之前记录的申请到的信息<br><img src="/2017/12/08/NetworkInZJU-Other/47.jpg"><br>2.选择L2TP选项，进行VPN客户端设置，用户名和密码填写自己VPN的用户名和密码<br><img src="/2017/12/08/NetworkInZJU-Other/48.jpg"><br>3.如果你申请IP的时候使用的MAC地址是PC的，那就需要在MAC克隆处填写记录的MAC地址（物理地址、网卡地址）</p><p><strong>保存设置，重启路由器以后看看能不能上网，可以的话就证明已经连接到了校园网</strong></p><h3 id="4-路由器加速器的配置"><a href="#4-路由器加速器的配置" class="headerlink" title="4. 路由器加速器的配置"></a>4. 路由器加速器的配置</h3><p>自行参照<a href="https://www.funjsq.com/support.html" target="_blank" rel="noopener">https://www.funjsq.com/support.html</a></p><h2 id="PC热点共享-加速器"><a href="#PC热点共享-加速器" class="headerlink" title="PC热点共享+加速器"></a>PC热点共享+加速器</h2><h3 id="1-开启加速器"><a href="#1-开启加速器" class="headerlink" title="1.开启加速器"></a>1.开启加速器</h3><p>加速器的安装、购买和使用以你买的加速器官网为准。</p><h3 id="2-配置wifi共享"><a href="#2-配置wifi共享" class="headerlink" title="2.配置wifi共享"></a>2.配置wifi共享</h3><p>win10自带热点功能，但是功能上有一定问题，比如5G网卡只能开5G的热点。不会用的下个猎豹WIFI之类的软件，台式机买一张支持AP的无线网卡（各类随身WIFI都有此功能）即可。<br>现在打开NS进行网络测试已经显示IP改变，并且NAT Type为A，打开游戏测试是否可以正常联机即可。</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;浙江大学主机游戏联机教程第三部分，主要讲解除了代理以外的联机方式，比如ChinaNet和流量卡&lt;/p&gt;
    
    </summary>
    
      <category term="教程" scheme="https://www.idkiro.xyz/categories/%E6%95%99%E7%A8%8B/"/>
    
    
      <category term="ChinaNet" scheme="https://www.idkiro.xyz/tags/ChinaNet/"/>
    
      <category term="联机" scheme="https://www.idkiro.xyz/tags/%E8%81%94%E6%9C%BA/"/>
    
      <category term="主机游戏" scheme="https://www.idkiro.xyz/tags/%E4%B8%BB%E6%9C%BA%E6%B8%B8%E6%88%8F/"/>
    
  </entry>
  
  <entry>
    <title>校园网联机攻略（VPN篇）</title>
    <link href="https://www.idkiro.xyz/2017/10/11/NetworkInZJU-VPN/"/>
    <id>https://www.idkiro.xyz/2017/10/11/NetworkInZJU-VPN/</id>
    <published>2017-10-11T08:21:46.000Z</published>
    <updated>2018-08-07T09:24:47.000Z</updated>
    
    <content type="html"><![CDATA[<p>浙江大学主机游戏联机教程第二部分，主要讲解VPN的使用和路由器的设置</p><a id="more"></a><h1 id="说明"><a href="#说明" class="headerlink" title="说明"></a>说明</h1><p>该教程撰写于2017年11月20日，不保证文章正确性。</p><p>该方案是为了解决两个问题：</p><ol><li>SOCKS5的UDP穿透功能并不是太好，NAT 类型虽然在NS上显示为Type A（PS4上为Type 2，两者的分法都有问题），但是实际联机时会和电信用户明显有沟，所以寻求VPN类的协议解决这个问题。</li><li>SS的各类客户端都对UDP的支持有限，最好的sstap也只能解决PC游戏联机的问题，对热点分享给主机的玩家毫无帮助。而部分VPN协议原生支持UDP，其效果比SS好得多，所以使用VPN可以让不想购买路由器的玩家也可以拯救校园网。</li></ol><p>本教程的阅读方法:<br><em>1.斜体为说明解释部分，可以不看</em><br><strong>2.粗体为重要提醒，请仔细阅读</strong></p><h1 id="教程"><a href="#教程" class="headerlink" title="教程"></a>教程</h1><h2 id="智能路由器-VPN-L2TP"><a href="#智能路由器-VPN-L2TP" class="headerlink" title="智能路由器+VPN(L2TP)"></a>智能路由器+VPN(L2TP)</h2><p>路由器固件多种多样，我用过最好用的就是padavan了，这里先介绍padavan的L2TP协议VPN的使用方法。</p><h3 id="1-给路由器安装padavan固件"><a href="#1-给路由器安装padavan固件" class="headerlink" title="1.给路由器安装padavan固件"></a>1.给路由器安装padavan固件</h3><p><em>本教程以<strong>斐讯k2</strong>安装padavan为例</em></p><p><strong>斐讯k2可下载群文件中的<img src="/2017/10/11/NetworkInZJU-VPN/1.png">，里面是一键刷机的整合包，内附简单操作步骤，成功后你可以跳过该部分。</strong></p><p>①首先你要知道你路由器的型号<br>比如极路由-极1s对应的型号一般是HC5661A，斐讯k2的对应的一般是PSG1218，这个型号可以在机身的贴纸上找到。</p><p>②下载路由所需要的padavan固件<br>打开下面的云盘。</p><p><a href="https://eyun.baidu.com/s/3kV0JV19" target="_blank" rel="noopener">https://eyun.baidu.com/s/3kV0JV19</a></p><p>进入最新的文件夹，下面会有很多的固件文件<br><img src="/2017/10/11/NetworkInZJU-VPN/2-300x176.png"><br>这时候按下Ctrl+F，也就是搜索页面上的信息，输入你的路由器型号<br><img src="/2017/10/11/NetworkInZJU-VPN/3.png"><br>就找到了你路由器的固件，斐讯k2有两个版本，你需要知道你的路由器的内存是256M还是64M的，然后下载正确的固件。斐讯k2默认是64M，如果你不清楚，那就选择64M的版本即可。</p><p>③给你的路由器刷入padavan固件<br>下面是斐讯k2的刷固件教程，其他型号请在恩山无线论坛中搜索相关教程。<br><a href="http://www.right.com.cn/forum/thread-209423-1-1.html" target="_blank" rel="noopener">http://www.right.com.cn/forum/thread-209423-1-1.html</a></p><h3 id="2-配置路由器的准备工作"><a href="#2-配置路由器的准备工作" class="headerlink" title="2.配置路由器的准备工作"></a>2.配置路由器的准备工作</h3><p><em>使用路由器需要用到学校的有线网络，相关教程cc98上有比较详细的，下面这个cc98的教程是让电脑直接连接有线的，我推荐没有用过有线的同学照着做一次来理解和测试。</em></p><p><a href="http://www.cc98.org/dispbbs.asp?boardID=226&amp;ID=2928932#4" target="_blank" rel="noopener">http://www.cc98.org/dispbbs.asp?boardID=226&amp;ID=2928932#4</a></p><p>以下是准备工作的简单教程：<br>对于紫金港校区，你只需要把网线插到路由器上就行，然后直接跳到路由器的设置。<br>对于玉泉校区和西溪校区（华家池和之江不了解），因为是静态IP所以需要申请有线网络IP，可以直接在微信的学生公寓公众号内实现，申请需要你的MAC地址，查看方法：在电脑上按win+r呼出运行界面，输入cmd，回车运行命令提示符，输入ipconfig/all后回车，找到你的MAC地址并记录（只要是个MAC地址就行，无论有线无线）<br><img src="/2017/10/11/NetworkInZJU-VPN/4.png"><br>申请后得到以下的信息并记录<br><img src="/2017/10/11/NetworkInZJU-VPN/5-300x271.png"><br>当然你需要用网线连接上你的路由器</p><h3 id="3-配置路由器上网"><a href="#3-配置路由器上网" class="headerlink" title="3.配置路由器上网"></a>3.配置路由器上网</h3><p>①进入padavan的控制台<br>一般在浏览器输入192.168.123.1即可，用户名密码都是admin</p><p>②设置L2TP来连接校园网<br>选择外部网络选项<br><img src="/2017/10/11/NetworkInZJU-VPN/6.png"><br>协议选择L2TP，加速可以都打开<br><img src="/2017/10/11/NetworkInZJU-VPN/7.png"><br>MAN IP设置填入之前记录的申请到的ip地址等信息，MTU你可以设置1428，有玄学加成（紫金港使用自动获取）<br><img src="/2017/10/11/NetworkInZJU-VPN/8.png"><br>DNS设置<br><img src="/2017/10/11/NetworkInZJU-VPN/tutorial_edit1.png"><br>VPN客户端设置，用户名和密码填写自己VPN的用户名和密码<br><img src="/2017/10/11/NetworkInZJU-VPN/tutorial_edit2.png"><br>填写记录的MAC地址（物理地址、网卡地址）<br><img src="/2017/10/11/NetworkInZJU-VPN/11.png"><br><strong>保存设置，重启路由器以后看看能不能上网，可以的话就证明已经连接到了校园网</strong></p><h3 id="4-配置VPN代理"><a href="#4-配置VPN代理" class="headerlink" title="4.配置VPN代理"></a>4.配置VPN代理</h3><p>①设置VPN<br>打开VPN客户端设置<br><img src="/2017/10/11/NetworkInZJU-VPN/9.png"><br>按照图中内容填写相关选项<br><img src="/2017/10/11/NetworkInZJU-VPN/10.png"><br><strong>平时不联机请关闭VPN以节省服务器流量，另外开着VPN会导致你无法上学校内网</strong><br>②测试VPN<br>设置完毕，在浏览器中打开以下网址</p><p><a href="http://www.ip138.com/" target="_blank" rel="noopener">http://www.ip138.com/</a></p><p>如果现实的IP已经不在杭州了，那就说明你VPN正常工作了。<br>使用NS测试，会发现IP和NAT TYPE都已经改变了，并且可以正常联机。</p><h2 id="PC热点共享-VPN-L2TP"><a href="#PC热点共享-VPN-L2TP" class="headerlink" title="PC热点共享+VPN(L2TP)"></a>PC热点共享+VPN(L2TP)</h2><h3 id="1-让电脑翻墙"><a href="#1-让电脑翻墙" class="headerlink" title="1.让电脑翻墙"></a>1.让电脑翻墙</h3><p>①设置VPN<br><strong>方法一：使用官方VPN客户端</strong><br>下载群文件中的VPN客户端<br><img src="/2017/10/11/NetworkInZJU-VPN/39.png"><br>安装客户端一直点击下一步即可<br><img src="/2017/10/11/NetworkInZJU-VPN/40.png"><br>安装完以后打开软件，双击添加新的VPN连接，第一次使用时会提示安装一个适配器，同意即可<br><img src="/2017/10/11/NetworkInZJU-VPN/41.png"><br>填写以下信息(一人一号，自行申请)：<br>主机名：<del>103.85.25.90</del><br>端口：5555<br>用户名：Kiro<br>密码：nsinzju<br>然后点击确定即可<br><img src="/2017/10/11/NetworkInZJU-VPN/42.png"><br>双击新加入的服务器进行连接<br><img src="/2017/10/11/NetworkInZJU-VPN/43.png"><br><strong>方法二：使用Windows自带客户端</strong><br>如图进行设置即可，注意共享秘钥也为nsinzju。<br><img src="/2017/10/11/NetworkInZJU-VPN/46.png"><br><strong>平时不联机请关闭VPN以节省服务器流量，另外开着全局VPN会导致你无法上学校内网</strong><br>②测试VPN<br>设置完毕，在浏览器中打开以下网址</p><p><a href="http://www.ip138.com/" target="_blank" rel="noopener">http://www.ip138.com/</a></p><p>如果现实的IP已经不在杭州了，那就说明你VPN正常工作了。</p><h3 id="2-配置wifi共享"><a href="#2-配置wifi共享" class="headerlink" title="2.配置wifi共享"></a>2.配置wifi共享</h3><p>因为VPN是全局的代理，包括TCP和UDP的协议的网络传输，在成功翻墙的情况下你只需要开启热点即可。<br>win10自带热点功能，不会用的下个猎豹WIFI之类的软件，台式机买一张支持AP的无线网卡（各类随身WIFI都有此功能）即可。<br>现在打开NS进行网络测试已经显示IP为填写的服务器IP，并且NAT Type为A，打开游戏测试是否可以正常联机即可。</p><h2 id="PC热点共享-VPN-OpenConnect"><a href="#PC热点共享-VPN-OpenConnect" class="headerlink" title="PC热点共享+VPN(OpenConnect)"></a>PC热点共享+VPN(OpenConnect)</h2><h3 id="1-让电脑翻墙-1"><a href="#1-让电脑翻墙-1" class="headerlink" title="1.让电脑翻墙"></a>1.让电脑翻墙</h3><p>①设置VPN<br>下载群文件中的VPN客户端，当然你也可以在GitHub上<a href="https://github.com/openconnect/openconnect-gui/releases" target="_blank" rel="noopener">下载</a>最新编译好的win32版本<br>安装客户端除了图中标示的界面需要进行修改，其他一直点击下一步即可<br><img src="/2017/10/11/NetworkInZJU-VPN/oc2.png"><br>安装完以后打开软件，点击此处的New profile添加新的VPN连接<br><img src="/2017/10/11/NetworkInZJU-VPN/oc3.png"><br>填写<a href="http://sh.nsinzju.top:5555" target="_blank" rel="noopener">http://sh.nsinzju.top:5555</a><br><img src="/2017/10/11/NetworkInZJU-VPN/oc4.png"><br>其中sh.nsinzju.top为域名，也可以是个IP，5555为端口<br>弹出警告，直接确认即可<br><img src="/2017/10/11/NetworkInZJU-VPN/oc5.png"><br>填写用户名<br><img src="/2017/10/11/NetworkInZJU-VPN/oc6.png"><br>填写密码<br><img src="/2017/10/11/NetworkInZJU-VPN/oc7.png"><br>点击Connect即可连接<br><img src="/2017/10/11/NetworkInZJU-VPN/oc8.png"><br>连接成功后锁会变成绿色<br><img src="/2017/10/11/NetworkInZJU-VPN/oc9-1.png"><br>②测试VPN<br>设置完毕，在浏览器中打开以下网址</p><p><a href="http://www.ip138.com/" target="_blank" rel="noopener">http://www.ip138.com/</a></p><p>如果现实的IP已经不在杭州了，那就说明你VPN正常工作了。</p><h3 id="2-配置wifi共享-1"><a href="#2-配置wifi共享-1" class="headerlink" title="2.配置wifi共享"></a>2.配置wifi共享</h3><p>因为VPN是全局的代理，包括TCP和UDP的协议的网络传输，在成功翻墙的情况下你只需要开启热点即可。<br>win10自带热点功能，不会用的下个猎豹WIFI之类的软件，台式机买一张支持AP的无线网卡（各类随身WIFI都有此功能）即可。<br>现在打开NS进行网络测试已经显示IP为填写的服务器IP，并且NAT Type为A，打开游戏测试是否可以正常联机即可。</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;浙江大学主机游戏联机教程第二部分，主要讲解VPN的使用和路由器的设置&lt;/p&gt;
    
    </summary>
    
      <category term="教程" scheme="https://www.idkiro.xyz/categories/%E6%95%99%E7%A8%8B/"/>
    
    
      <category term="联机" scheme="https://www.idkiro.xyz/tags/%E8%81%94%E6%9C%BA/"/>
    
      <category term="主机游戏" scheme="https://www.idkiro.xyz/tags/%E4%B8%BB%E6%9C%BA%E6%B8%B8%E6%88%8F/"/>
    
      <category term="VPN" scheme="https://www.idkiro.xyz/tags/VPN/"/>
    
  </entry>
  
  <entry>
    <title>校园网联机攻略（SS篇）</title>
    <link href="https://www.idkiro.xyz/2017/08/23/NetworkInZJU-SS/"/>
    <id>https://www.idkiro.xyz/2017/08/23/NetworkInZJU-SS/</id>
    <published>2017-08-23T07:26:43.000Z</published>
    <updated>2018-08-07T09:24:38.000Z</updated>
    
    <content type="html"><![CDATA[<p>浙江大学主机游戏联机教程第一部分，主要讲解SS的使用和路由器的设置</p><a id="more"></a><h1 id="说明"><a href="#说明" class="headerlink" title="说明"></a>说明</h1><p>该教程撰写于2017年11月20日，不保证文章正确性。</p><p>本教程的阅读方法:<br><em>1.斜体为说明解释部分，可以不看</em><br><strong>2.粗体为重要提醒，请仔细阅读</strong></p><h1 id="教程"><a href="#教程" class="headerlink" title="教程"></a>教程</h1><h2 id="智能路由器-SS"><a href="#智能路由器-SS" class="headerlink" title="智能路由器+SS"></a>智能路由器+SS</h2><p><em>如果你已经有一个智能路由器了，比如固件可以刷成老毛子(padavan)固件或者梅林固件的路由器（当然有很多功能类似的固件）。除了阅读这份教程以外，你可以逛恩山无线论坛，里面有各种路由器型号的固件下载、刷固件教程以及设置教程，有问题也可以在群中@我。</em><br><em>比较常见并且便宜的支持padavan固件的路由器：小米路由、极路由、斐讯等等。</em><br><em>有钱一点的可以买个华硕的路由器，可以刷梅林固件，当然土豪可以买网件的路由器。</em><br><em>另外极路由有一个15天解锁刷机的期限，如果急着用推荐买二手</em></p><h3 id="1-给路由器安装padavan固件"><a href="#1-给路由器安装padavan固件" class="headerlink" title="1.给路由器安装padavan固件"></a>1.给路由器安装padavan固件</h3><p><em>本教程以<strong>斐讯k2</strong>安装padavan为例</em></p><p><strong>斐讯k2可下载群文件中的<img src="/2017/08/23/NetworkInZJU-SS/1.png">，里面是一键刷机的整合包，内附简单操作步骤，成功后你可以跳过该部分。</strong></p><p>①首先你要知道你路由器的型号<br>比如极路由-极1s对应的型号一般是HC5661A，斐讯k2的对应的一般是PSG1218，这个型号可以在机身的贴纸上找到。</p><p>②下载路由所需要的padavan固件<br>打开下面的云盘中的一个。</p><p><a href="https://eyun.baidu.com/s/3pLMbUqR" target="_blank" rel="noopener">https://eyun.baidu.com/s/3pLMbUqR</a><br><a href="http://opt.cn2qq.com/padavan/" target="_blank" rel="noopener">http://opt.cn2qq.com/padavan/</a></p><p>进入最新的文件夹，下面会有很多的固件文件<br><img src="/2017/08/23/NetworkInZJU-SS/2-300x176.png"><br>这时候按下Ctrl+F，也就是搜索页面上的信息，输入你的路由器型号<br><img src="/2017/08/23/NetworkInZJU-SS/3.png"><br>就找到了你路由器的固件，斐讯k2有两个版本，你需要知道你的路由器的内存是256M还是64M的，然后下载正确的固件。斐讯k2默认是64M，如果你不清楚，那就选择64M的版本即可。</p><p>③给你的路由器刷入padavan固件<br>下面是斐讯k2的刷固件教程，其他型号请在恩山无线论坛中搜索相关教程。<br><a href="http://www.right.com.cn/forum/thread-209423-1-1.html" target="_blank" rel="noopener">http://www.right.com.cn/forum/thread-209423-1-1.html</a></p><h3 id="2-配置路由器的准备工作"><a href="#2-配置路由器的准备工作" class="headerlink" title="2.配置路由器的准备工作"></a>2.配置路由器的准备工作</h3><p><em>使用路由器需要用到学校的有线网络，相关教程cc98上有比较详细的，下面这个cc98的教程是让电脑直接连接有线的，我推荐没有用过有线的同学照着做一次来理解和测试。</em></p><p><a href="http://www.cc98.org/dispbbs.asp?boardID=226&amp;ID=2928932#4" target="_blank" rel="noopener">http://www.cc98.org/dispbbs.asp?boardID=226&amp;ID=2928932#4</a></p><p>以下是准备工作的简单教程：<br>对于紫金港校区，你只需要把网线插到路由器上就行，然后直接跳到路由器的设置。<br>对于玉泉校区和西溪校区（华家池和之江不了解），因为是静态IP所以需要申请有线网络IP，可以直接在微信的学生公寓公众号内实现，申请需要你的MAC地址，查看方法：在电脑上按win+r呼出运行界面，输入cmd，回车运行命令提示符，输入ipconfig/all后回车，找到你的MAC地址并记录（只要是个MAC地址就行，无论有线无线）<br><img src="/2017/08/23/NetworkInZJU-SS/4.png"><br>申请后得到以下的信息并记录<br><img src="/2017/08/23/NetworkInZJU-SS/5-300x271.png"><br>当然你需要用网线连接上你的路由器</p><h3 id="3-配置路由器上网"><a href="#3-配置路由器上网" class="headerlink" title="3.配置路由器上网"></a>3.配置路由器上网</h3><p>①进入padavan的控制台<br>一般在浏览器输入192.168.123.1即可，用户名密码都是admin</p><p>②设置L2TP来连接校园网<br>选择外部网络选项<br><img src="/2017/08/23/NetworkInZJU-SS/6.png"><br>协议选择L2TP，加速可以都打开<br><img src="/2017/08/23/NetworkInZJU-SS/7.png"><br>MAN IP设置填入之前记录的申请到的ip地址等信息，MTU你可以设置1428，有玄学加成（紫金港使用自动获取）<br><img src="/2017/08/23/NetworkInZJU-SS/8.png"><br>DNS设置<br><img src="/2017/08/23/NetworkInZJU-SS/tutorial_edit1.png"><br>VPN客户端设置，用户名和密码填写自己VPN的用户名和密码<br><img src="/2017/08/23/NetworkInZJU-SS/tutorial_edit2.png"><br>填写记录的MAC地址（物理地址、网卡地址）<br><img src="/2017/08/23/NetworkInZJU-SS/11.png"><br><strong>保存设置，重启路由器以后看看能不能上网，可以的话就证明已经连接到了校园网</strong></p><h3 id="4-配置SS代理"><a href="#4-配置SS代理" class="headerlink" title="4.配置SS代理"></a>4.配置SS代理</h3><p>①设置ShadowSocks来翻墙和联机<br>选择ShadowSocks选项<br><img src="/2017/08/23/NetworkInZJU-SS/12.png"><br>填写需要的信息如下<br>服务器IP：<del>103.85.25.90</del><br>服务器端口：443<br>密码：nsinzju<br>加密：rc4-md5<br>联机的时候工作模式选择大陆白名单或者全局模式，这样才可以设置UDP转发<br><img src="/2017/08/23/NetworkInZJU-SS/13.png"><br>打开UDP转发<br><img src="/2017/08/23/NetworkInZJU-SS/tutorial_edit3.png"><br>②测试ShadowSocks的翻墙和联机功能<br>设置完毕，你可以在浏览器中打开以下网址</p><p><a href="https://www.google.com.hk/" target="_blank" rel="noopener">https://www.google.com.hk/</a></p><p>如果已经可以访问，那么证明ss的基本翻墙功能已经开启<br>其他WIFI的SSID和密码的设置请按自己喜好设置<br>现在打开NS进行网络测试已经显示IP为填写的服务器IP，并且NAT Type为A，打开游戏测试是否可以正常联机即可。</p><h2 id="PC热点共享-SS"><a href="#PC热点共享-SS" class="headerlink" title="PC热点共享+SS"></a>PC热点共享+SS</h2><h3 id="1-让电脑翻墙"><a href="#1-让电脑翻墙" class="headerlink" title="1.让电脑翻墙"></a>1.让电脑翻墙</h3><p>软件群文件中已经有分享<br><img src="/2017/08/23/NetworkInZJU-SS/23.png"><br>解压到自己喜欢的路径<br><img src="/2017/08/23/NetworkInZJU-SS/24.png"><br>文件夹中选择中的这个exe文件就是要运行的SSR了，方便每次运行，请右键并选择如图所示选项生成一个桌面快捷方式<br><img src="/2017/08/23/NetworkInZJU-SS/25.png"><br>现在打开软件，如果没看到界面请在系统托盘<img src="/2017/08/23/NetworkInZJU-SS/26.png">里找这个纸飞机，并双击打开设置界面<br><img src="/2017/08/23/NetworkInZJU-SS/27.png"><br>选择添加(如果之前有一个广告信息请点击删除)，在右侧的输入框内输入以下信息（没提到的可以不管）<br>服务器IP：<del>103.85.25.90</del><br>服务器端口：443<br>密码：nsinzju<br>加密：rc4-md5<br>打开高级选项，UDP端口:443<br><img src="/2017/08/23/NetworkInZJU-SS/28.png"><br>托盘右键选择pac模式（如果你是要进行联机，那最好是改为<strong>全局模式</strong>，因为任天堂服务器并没有被墙）<br><img src="/2017/08/23/NetworkInZJU-SS/29.png"><br>以下部分一般不用设置先跳过，如果不能翻墙再来设置</p><blockquote><p>选择此项更新pac文件<br><img src="/2017/08/23/NetworkInZJU-SS/30.png"><br>选择我们添加的服务器<br><img src="/2017/08/23/NetworkInZJU-SS/31.png"></p></blockquote><p>设置完毕，你可以在浏览器中打开以下网址</p><p><a href="https://www.google.com.hk/" target="_blank" rel="noopener">https://www.google.com.hk/</a></p><p>如果已经可以访问，那么证明ss的基本翻墙功能已经开启</p><h3 id="2-配置wifi共享"><a href="#2-配置wifi共享" class="headerlink" title="2.配置wifi共享"></a>2.配置wifi共享</h3><p>首先当然你需要会开启WIFI热点分享网络，虽然win10自带有热点分享的功能，但是那个有很多问题，所以推荐还是省心点下个一键开启热点的软件，比如猎豹wifi和360wifi。<br>用手机测试下开启的热点看是否为2.4G的WIFI，如果你的手机（或者其他设备）可以连接热点进行上网了，那就可以开始配置SS了。<br>右键菜单选择选项设置<br><img src="/2017/08/23/NetworkInZJU-SS/32.png"><br>出现以下设置界面<br><img src="/2017/08/23/NetworkInZJU-SS/33.png"><br>在本地代理中勾选“允许来自局域网的连接”，端口这里默认1080，这个之后需要用到<br><img src="/2017/08/23/NetworkInZJU-SS/34.png"><br>接下来需要查询你电脑的本地ip<br>具体方法：在电脑上按win+r呼出运行界面，输入cmd，回车运行命令提示符，输入ipconfig，回车，找到你的ipv4地址，如果有两个无线网卡，那就记下分享WIFI的无线网卡的IPV4地址。<br><img src="/2017/08/23/NetworkInZJU-SS/35.png"><br><strong>如果你是连接ZJUWLAN以后再进行分享的，那你需要固定你的IP，否则你每次都需要重新设置IP</strong></p><blockquote><p>打开网络和共享中心<br><img src="/2017/08/23/NetworkInZJU-SS/45.png"><br>打开更改适配器设置，然后打开WLAN的属性<br><img src="/2017/08/23/NetworkInZJU-SS/36.png"><br>再打开IPV4的属性，填写你之前记录的IP<br><img src="/2017/08/23/NetworkInZJU-SS/37.png"></p></blockquote><p>拿出你的NS（PS4之类的主机方法都是一样的）<br>连接上你开启的wifi热点，然后进行手动设置<br>这里IP地址设置和DNS设置都默认，也就是自动获取<br>Proxy Settings选on，Server填你刚才查到的电脑本地IP，Port填刚记下来的端口也就是1080（NS设置图来源于网络）<br><img src="/2017/08/23/NetworkInZJU-SS/38.png"><br>保存设置即可，这时候你已经让NS翻墙了。<br>现在打开NS进行网络测试已经显示IP为填写的服务器IP，但是NAT Type依旧为D，说明NS已经翻墙但是还不支持联机，因为联机使用的协议是UDP。</p><h3 id="3-配置UDP转发"><a href="#3-配置UDP转发" class="headerlink" title="3.配置UDP转发"></a>3.配置UDP转发</h3><p>因为SOCKS5协议的特殊性，其UDP转发存在一定的限制，虽然有强制让全局代理的win平台软件可以使用，但是经过测试是无法让热点流量也全部进行转发的，所以热点共享的方法无法给主机游戏也提供加速。</p><p>如果你只是想将SS用于PC平台的联机，可以使用<a href="https://www.sockscap64.com/zh-hant/sstap/" target="_blank" rel="noopener">SSTap</a>。</p><p>当然如果有大佬知道相应的解决方法，请联系我。</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;浙江大学主机游戏联机教程第一部分，主要讲解SS的使用和路由器的设置&lt;/p&gt;
    
    </summary>
    
      <category term="教程" scheme="https://www.idkiro.xyz/categories/%E6%95%99%E7%A8%8B/"/>
    
    
      <category term="联机" scheme="https://www.idkiro.xyz/tags/%E8%81%94%E6%9C%BA/"/>
    
      <category term="主机游戏" scheme="https://www.idkiro.xyz/tags/%E4%B8%BB%E6%9C%BA%E6%B8%B8%E6%88%8F/"/>
    
      <category term="SS" scheme="https://www.idkiro.xyz/tags/SS/"/>
    
  </entry>
  
</feed>
